/*! For license information please see index.js.LICENSE.txt */
(()=>{var t,e,n={28:t=>{function e(t,e){return Object.keys(e).forEach((function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})})),t}function n(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}n(t.exports,"utils",(()=>i));var i={},o={};function r(t){return new Promise((e=>setTimeout((()=>e()),t)))}n(o,"delay",(()=>r));var s={};function a(){const t=new URLSearchParams(window.location.search.substring(1));return Boolean(t.get("adengine_debug"))?t.get("adengine_debug"):t.get("identity_debug")}n(s,"getDebugGroup",(()=>a));var c={};n(c,"localStorageHelper",(()=>d));class d{constructor(t,e=6e4){this.key=t,this.ttlInMilliseconds=e;let n=!1;try{n=void 0!==window.localStorage&&null!==window.localStorage,n&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(t){n=!1}const i=t=>window?.instantConfigCache?.[t]??null,o=(t,e)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[t]=e};this.storageAdapter={getItem:t=>{try{return n?window.localStorage.getItem(t)??i(t):i(t)}catch(e){return i(t)}},setItem:(t,e)=>{try{if(n)return localStorage.setItem(t,e);o(t,e)}catch(n){o(t,e)}}}}set(t){const e=this.getObjectToStore(t);this.storageAdapter.setItem(this.key,JSON.stringify(e))}get(){const t=this.storageAdapter.getItem(this.key);return t?this.parseStoredValue(JSON.parse(t)):null}expired(t){return!t||t<Date.now()}getObjectToStore(t){return{data:t,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(t){return this.expired(t?.ttl)?null:t.data}}var u={};n(u,"lock",(()=>h)),n(u,"release",(()=>p));const l=new d("instant-config-lock",1e3);function h(){return"lock"===l.get()||(l.set("lock"),!1)}function p(){l.set(null)}var f={};n(f,"getTimeDelta",(()=>m)),n(f,"logger",(()=>w)),n(f,"warner",(()=>b));const g=a()||"",v=g.split(","),y=Date.now();function m(){return((Date.now()-(window.performance?.timeOrigin??y))/1e3).toFixed(4)}function w(t,...e){""!==g&&("1"!==g&&-1===v.indexOf(t)||window.console.info(`${m()}s\t\t ${t}`,e))}function b(t,...e){""!==g&&("1"!==g&&-1===v.indexOf(t)||window.console.warn(t,e))}e(i,s),e(i,f),e(i,o),e(i,c),e(i,u);var C={},j={};n(j,"EmptyInstantConfigCacheStorage",(()=>O));class O{get(t){}set(t){}remove(t){}}var S={};n(S,"InstantConfigInterpreter",(()=>Y));var k={},Q={};function E(t){return Array.isArray(t)&&t.length>0&&"object"==typeof t[0]}n(Q,"shouldBeListOfConfigGroups",(()=>E));var T={};n(T,"negativePrefix",(()=>I)),n(T,"cacheSuffix",(()=>R)),n(T,"samplingSeparator",(()=>_)),n(T,"worldWide",(()=>P)),n(T,"precision",(()=>W)),n(T,"experimentBucketSettingKey",(()=>A));const I="non-",R="-cached",_="/",P="XX",W=10**6,A="eb";e(k,{}),e(k,{}),e(k,{}),e(k,Q),e(k,{}),e(k,{}),e(k,{}),e(k,{}),e(k,{}),e(k,T),e(k,{});class M{constructor(t,e,n){this.container=e,this.settingsRepository=n,"number"==typeof t?this.experimentBucket=this.manageSampling(t):!0===t?this.experimentBucket=this.manageSampling(0):!1===t?this.clean():this.experimentBucket=Math.round(100*Math.random())}build(){return()=>this.experimentBucket}manageSampling(t){const e=this.readFromLoaderVariable()??this.readFromSettings()??Math.round(100*Math.random());return this.storeInLoaderVariable(e),this.storeInSettings(e,t),e}readFromLoaderVariable(){return this.container.fandomContext?.experimentBucket}readFromSettings(){const t=this.settingsRepository&&this.settingsRepository.get(A);return t&&Number(t)}storeInSettings(t,e){this.settingsRepository&&this.settingsRepository.set(A,t.toString(),e)}storeInLoaderVariable(t){this.container.fandomContext=this.container.fandomContext||{},this.container.fandomContext.experimentBucket=t}clean(){this.settingsRepository&&this.settingsRepository.remove(A)}}var x={},D={};n(D,"BrowserMatcher",(()=>L));var G={};function N(t){return t.startsWith(I)?{value:t.replace(I,""),negated:!0}:{value:t,negated:!1}}n(G,"extractNegation",(()=>N));class L{constructor(t){this.currentBrowser=t?.toLowerCase()}isValid(t){const e=t.b??t.browsers??[],n=e.map((t=>t.toLowerCase())).map((t=>N(t)));return 0===e.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,n)&&n.some((t=>this.currentBrowser.includes(t.value)!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var V={};n(V,"DeviceMatcher",(()=>U));class U{constructor(t){this.currentDevice=t}isValid(t){const e=(t.d??t.devices??[]).map((t=>t.toLowerCase())).map((t=>N(t)));return 0===e.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,e)&&e.some((t=>t.value===this.currentDevice!==t.negated))}isCurrentNegated(t,e){return e.some((e=>t.includes(e.value)&&e.negated))}}var F={};n(F,"DomainMatcher",(()=>H));class H{isValid(t){const e=t.o??t.domains??[];return 0===e.length||e.some((t=>window.location.hostname.includes(t)))}}var $={};n($,"RegionMatcher",(()=>B));class B{constructor(t){this.geo=t}isValid(t,e){const n=t.r??t.regions??[],i=this.filterOutInvalidRegions(n);return e?e(i):this.isProperGeo(i)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(t=[]){return!(!t||!t.indexOf||this.isGeoExcluded(t)||!(this.isProperContinent(t)||this.isProperCountry(t)||this.isProperRegion(t)))}filterOutInvalidRegions(t){return t.filter((t=>!t.includes(_))).filter((t=>!t.includes(R)))}isProperCountry(t){return!!(t&&t.indexOf&&(t.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(t,this.getCountryCode())))}isProperRegion(t){const e=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(t&&t.indexOf&&(t.indexOf(e)>-1||this.isSampledForGeo(t,e)))}containsContinent(t){const e=`${P}-${this.getContinentCode()}`;return t.indexOf(e)>-1||this.isSampledForGeo(t,e)}containsWorldWide(t){return t.indexOf(P)>-1||this.isSampledForGeo(t,P)}isProperContinent(t){return!(!t||!t.indexOf||!this.containsWorldWide(t)&&!this.containsContinent(t))}isGeoExcluded(t){return!!(t.indexOf(`${I}${this.getCountryCode()}`)>-1||t.indexOf(`${I}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||t.indexOf(`${I}${P}-${this.getContinentCode()}`)>-1)}hasSampling(t){return e=>0!==e.indexOf(I)&&e.indexOf(t+_)>-1}getSamplingLimits(t){let[,e]=t.split(_);return e=e.replace(R,""),Math.round(parseFloat(e)*W)||0}isSampledForGeo(t,e){const n=t.filter(this.hasSampling(e));if(0===n.length)return!1;const i=Math.round(Math.random()*(100*W))||0;return n.map((t=>this.getSamplingLimits(t))).some((t=>i<t))}}var q={};n(q,"SamplingCacheManager",(()=>z));class z{constructor(t){this.cacheStorage=t,this.precision=10**6,this.samplingProvider=()=>100*Math.random()}setSamplingProvider(t){this.samplingProvider=t}apply(t,e,n){const i=this.cacheStorage.get(t);if(void 0!==i){if(this.isCachedValueValid(i,e))return i.result;this.cacheStorage.remove(t)}const o=n(),r=e.s??e.sampling,s=e.c??e.samplingCache;if("number"!=typeof r||!1===o)return o;const a=this.getSamplingResult(r),c={name:t,result:a,withCookie:Boolean(s),group:a?"B":"A",limit:this.getLimit(a,r)};return this.cacheStorage.set(c),a}getSamplingResult(t){const e=Math.round(this.samplingProvider()*this.precision);return Math.round(t*this.precision)>e}isCachedValueValid(t,e){return e.samplingCache&&"number"==typeof e.sampling&&t.limit==this.getLimit(t.result,e.sampling)}getLimit(t,e){return+(t?e:100-e).toFixed(6)}}e(x,D),e(x,V),e(x,F),e(x,G),e(x,$),e(x,q);class Y{constructor(t=new L,e=new U,n=new H,i=new B,o=new O,r){this.browserMatcher=t,this.deviceMatcher=e,this.domainMatcher=n,this.regionMatcher=i,this.settingsRepository=r,this.logGroup="instant-config-interpreter",this.configResponse={},this.samplingCache=new z(o)}init(t,e={},n,i=window){this.configResponse={...e,...t},this.regionValidationPredicate=n;const o=this.getValueWithoutCache("icExperimentBucket");if(void 0!==o){const t=new M(o,i,this.settingsRepository).build();this.samplingCache.setSamplingProvider(t)}return this}getValues(){return i.logger(this.logGroup,"get values called with",this.configResponse),Object.keys(this.configResponse).map((t=>({key:t,value:this.configResponse[t]}))).map((({key:t,value:e})=>E(e)?{key:t,value:this.getValueFromGroups(t,e)}:{key:t,value:e})).reduce(((t,e)=>({...t,[e.key]:e.value})),{})}getValueWithoutCache(t){const e=this.configResponse[t];if(E(e)){const t=e.find(this.isValid.bind(this));return t&&(t.v??t.value)}return e}getValueFromGroups(t,e){const n=e.find(((e,n)=>this.samplingCache.apply(`${t}-${n}`,e,(()=>this.isValid(e)))));if(void 0!==n)return n.v??n.value}isValid(t){return this.browserMatcher.isValid(t)&&this.deviceMatcher.isValid(t)&&this.domainMatcher.isValid(t)&&this.regionMatcher.isValid(t,this.regionValidationPredicate)}}var K={};async function X(t,e=2e3){const n=new AbortController,i=setTimeout((()=>n.abort()),e),o=await fetch(t,{signal:n.signal});return clearTimeout(i),o}n(K,"InstantConfigLoader",(()=>Z));const J="instant-config-loader";class Z{constructor(t,e=window){this.params=t,this.container=e,this.storage=new i.localStorageHelper(`instant-config-${t.appName}`,6e4),this.container.icbm=this.container.icbm||{},this.instantConfig=this.container.instantConfig,this.lockDelay="number"==typeof t.lockDelay?t.lockDelay:500}async getConfig(){if(this.instantConfig)return this.instantConfig;let t;return this.lockDelay>0?t=this.fetchInstantConfigThroughCache():(this.container.icbm.fetch||(this.container.icbm.fetch=this.fetchInstantConfig()),t=this.container.icbm.fetch),t.then((t=>t??this.fetchFallbackConfig()))}async fetchInstantConfigThroughCache(t=!1){if(i.lock()&&!t)return i.logger(J,"locked, awaiting",this.lockDelay),await r(this.lockDelay),this.fetchInstantConfigThroughCache(!0);try{const t=this.storage.get();if(t)return i.logger(J,"instant config pulled from local storage",t),JSON.parse(t);const e=await this.fetchInstantConfig();return e&&this.storage.set(JSON.stringify(e)),i.release(),e}catch(t){i.warner(J,"could not get instant config via cache",t),i.release()}}async fetchInstantConfig(){const t=`${this.params.instantConfigEndpoint??"https://services.fandom.com"}/${this.params.instantConfigVariant??"icbm"}/api/config?app=${this.params.appName}`;try{const e=await X(t,this.params.requestTimeout);if(!e.ok)return;const n=await e.json();return i.logger(J,"instant config fetched",n),n}catch(t){return void i.warner(J,"could not fetch instant config",t)}}async fetchFallbackConfig(){i.logger(J,"Fetching fallback config");const t=this.params.instantConfigFallbackEndpoint;if(void 0===t)return{};try{i.logger(J,t);const e=await X(t,this.params.requestTimeout);if(!e.ok)return{};const n=await e.json();return i.logger(J,"fallback config fetched",n),n}catch(t){return i.warner(J,"could not fetch fallback config",t),{}}}}var tt={};n(tt,"InstantConfigOverrider",(()=>nt));const et=["InstantGlobals","icbm"];class nt{override(t,e){return[...t.keys()].filter((t=>{return e=t,et.some((t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`)));var e})).map((t=>{const[,e]=t.split(".").map((t=>t.split("__"))).flat();return{paramKey:t,key:e}})).map((({paramKey:e,key:n})=>({key:n,value:this.parseValue(t.get(e))}))).reduce(((t,{key:e,value:n})=>({...t,[e]:n})),e)}parseValue(t){if("true"===t||"false"===t)return"true"===t;const e=parseInt(t,10);if(t===`${e}`)return e;try{return JSON.parse(t)}catch(e){return t||null}}}e(C,j),e(C,S),e(C,K),e(C,tt),e(C,x),e(t.exports,C),e(t.exports,k)},155:(t,e,n)=>{"use strict";n.d(e,{r:()=>i});class i{constructor(t,e){this.__global=!0,this.timestamp=Date.now(),this.name=t.name,this.category=t.category||"[Identity]",this.type=`${this.category} ${t.name}`,Object.assign(this,e)}}},85:(t,e,n)=>{"use strict";n.d(e,{U:()=>S});var i=n(635),o=function(){return o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)},r={channelId:"default",host:window,coordinatorHost:window.top},s={connect:"connect",connected:"connected"},a="@wikia/post-quecast";function c(t){return t.channelId&&t.libId===a&&t.action&&function(t){return"string"==typeof t.type&&"number"==typeof t.timestamp}(t.action)}function d(t){return!t.data.private}function u(t,e){return t.data.channelId===e}function l(t){return t.data.action}var h=function(){function t(){}return t.make=function(t){return function(t){var e;return t.host===t.coordinatorHost&&!!(null===(e=t.coordinatorHost[a])||void 0===e?void 0:e.callbackConnector)}(t)?t.coordinatorHost[a].callbackConnector:new f({senderHost:t.coordinatorHost,listenerHost:t.host})},t}(),p=function(){function t(t){this.coordinatorHost=t,this.callbacks=[]}return t.prototype.dispatch=function(t){var e=this;if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.callbacks.forEach((function(n){return n({data:t,source:e.coordinatorHost})}))},t.prototype.addListener=function(t){this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),f=function(){function t(t){this.options=t,this.map=new Map}return t.prototype.dispatch=function(t){if(!c(t))throw new Error("Incorrect object type. Expected PostMessageData, but got "+t);this.options.senderHost.postMessage(t,"*")},t.prototype.addListener=function(t){var e=function(e){var n;(n=e)&&n.source&&n.data&&c(n.data)&&t(e)};this.map.set(t,e),this.options.listenerHost.addEventListener("message",e)},t.prototype.removeListener=function(t){var e=this.map.get(t);this.options.listenerHost.removeEventListener("message",e),this.map.delete(t)},t}(),g=function(){function t(t){this.callbacks=[],this.history=[],this.channelId=t.channelId,this.connector=h.make(t),this.setupActions(),this.setupConnection()}return t.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},t.prototype.getHistory=function(){var t=this,e=function(n){if(u(n,t.channelId)&&function(t){return!!t.data.private}(n)){var i=l(n);(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.type===e}))})(i,s.connected)&&(t.connector.removeListener(e),t.handleActions.apply(t,i.history))}};this.connector.addListener(e)},t.prototype.listenEvent=function(){var t=this;this.connector.addListener((function(e){if(u(e,t.channelId)&&d(e)){var n=l(e);t.handleActions(n)}}))},t.prototype.handleActions=function(){for(var t,e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];(t=this.history).push.apply(t,n),n.forEach((function(t){return e.callbacks.forEach((function(e){return e(t)}))}))},t.prototype.setupConnection=function(){this.connector.dispatch({action:{type:s.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:a})},t.prototype.addListener=function(t){this.history.forEach((function(e){return t(e)})),this.callbacks.push(t)},t.prototype.removeListener=function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))},t}(),v=function(){function t(t){void 0===t&&(t={});var e=o(o({},r),t);this.channelId=e.channelId,this.connector=h.make(e)}return t.prototype.dispatch=function(t){this.connector.dispatch({action:o(o({},t),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:a})},t}(),y=function(){function t(t){void 0===t&&(t={});var e=o(o({},r),t);this.transmitter=new v(e),this.receiver=new g(e)}return t.prototype.dispatch=function(t){this.transmitter.dispatch(t)},t.prototype.addListener=function(t){this.receiver.addListener(t)},t.prototype.removeListener=function(t){this.receiver.removeListener(t)},t}(),m=function(){function t(t,e){this.channelId=t,this.connectors=new Map,this.history=[],this.connectors.set(e,e[a].callbackConnector)}return t.prototype.addConnection=function(t){this.ensureConnector(t).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:a})},t.prototype.createConnectedAction=function(){return{type:s.connected,history:this.history,timestamp:Date.now()}},t.prototype.broadcast=function(t){var e=this;this.history.push(t),this.connectors.forEach((function(n){n.dispatch({action:t,channelId:e.channelId,libId:a})}))},t.prototype.ensureConnector=function(t){return this.connectors.has(t)||this.connectors.set(t,new f({senderHost:t,listenerHost:t})),this.connectors.get(t)},t}(),w=function(){function t(t){this.coordinatorHost=t,this.channels=new Map,this.callbackConnector=new p(t),this.postMessageConnector=new f({senderHost:t,listenerHost:t})}return t.prototype.init=function(){var t=this,e=function(e){d(e)||(t.handleConnect(e),t.handleBroadcast(e))};this.callbackConnector.addListener(e),this.postMessageConnector.addListener(e)},t.prototype.handleConnect=function(t){(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.some((function(e){return t.data.action.type===e}))})(t,s.connect)&&this.ensureChannel(t.data.channelId).addConnection(t.source)},t.prototype.handleBroadcast=function(t){(function(t){return!Object.values(s).some((function(e){return t.data.action.type===e}))})(t)&&this.ensureChannel(t.data.channelId).broadcast(t.data.action)},t.prototype.ensureChannel=function(t){return this.channels.has(t)||this.channels.set(t,new m(t,this.coordinatorHost)),this.channels.get(t)},t}();function b(t){if(void 0===t&&(t=window),!t[a]){var e=new w(t);e.init(),t[a]=e}}var C,j=n(223),O=n(393);let S=class{constructor(t){this.window=t,this.history=new Map;const{channelId:e,coordinatorName:n}=this.getSettings();b(),this.communicator=new y({channelId:e||"default",coordinatorHost:t[n]||top})}emit(t){this.communicator.dispatch(t)}on(t,e){this.communicator.addListener((n=>this.run(n,t,e)))}once(t,e){this.communicator.addListener((n=>this.runOnce(n,t,e)))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(t,e,n){this.ofType(t,e)&&n(t)}runOnce(t,e,n){const i=e.category+" "+e.name;this.ofType(t,e)&&(this.history.has(i)||(this.history.set(i,!0),n(t)))}ofType(t,e){return t.category===e.category&&t.name===e.name||t.type===e.category+" "+e.name}};S=(0,i.Cg)([(0,j.Gr)(),(0,i.Qj)(0,(0,j.WQ)(O.jf)),(0,i.Sn)("design:paramtypes",["function"==typeof(C="undefined"!=typeof Window&&Window)?C:Object])],S)},349:(t,e,n)=>{"use strict";n.d(e,{c:()=>i});const i={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"},CONSENT_UPDATE:{category:"[AdEngine OptIn]",name:"update opt in"},IDENTITY_READY:{category:"[IdentityEngine]",name:"Identity ready"},SEND_ONETRUST_EVENTS:{category:"[IdentityEngine]",name:"Send OneTrust events"},IDENTITY_PARTNER_DATA_OBTAINED:{category:"[AdEngine]",name:"Identity partner data obtained"},AGE_GATE_DATA:{name:"Age gate result",category:"[Identity]"},PAGE_CHANGED:{name:"Page changed",category:"[Platform]"},INSTANT_CONFIG_CACHE_READY:{category:"[AdEngine]",name:"Instant Config cache ready"},AUDIGENT_SEGMENT_LIBRARY_LOADED:{name:"Audigent segment library loaded"},AUDIGENT_MATCHES_LIBRARY_LOADED:{name:"Audigent matches library loaded"},AUDIGENT_SEGMENTS_READY:{name:"Audigent segments ready"},EYEOTA_STARTED:{name:"Eyeota started"},EYEOTA_FAILED:{name:"Eyeota loading failed"},LIVE_CONNECT_STARTED:{name:"LiveConnect started"},LIVE_CONNECT_CACHED:{name:"LiveConnect data cached"},LIVE_CONNECT_RESPONDED_UUID:{name:"LiveConnect responded with UUID"}}},841:(t,e,n)=>{"use strict";n.d(e,{X:()=>pt});var i,o,r,s=n(635),a=n(223),c=n(144),d=n(858),u=n(439),l=n(538),h=n(610);let p=class{constructor(t,e,n){this.adsContext=t,this.platform=e,this.device=n,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp",fanatical:"fanatical"}}get(){var t,e;const n=this.platform.get(),i="desktop"===this.device.getDeviceType()?"desktop":"mobile";return(null===(t=this.adsContext.get())||void 0===t?void 0:t.skin)?`${null!==(e=this.adsContext.get().skin)&&void 0!==e?e:n}_${i}`:this.skinMap[n]?this.skinMap[n]+"_"+i:"unknown"}};p=(0,s.Cg)([(0,a.Gr)(),(0,s.Qj)(0,(0,a.WQ)(h.i)),(0,s.Qj)(1,(0,a.WQ)(u.O)),(0,s.Qj)(2,(0,a.WQ)(l.p)),(0,s.Sn)("design:paramtypes",["function"==typeof(i=void 0!==h.i&&h.i)?i:Object,"function"==typeof(o=void 0!==u.O&&u.O)?o:Object,"function"==typeof(r=void 0!==l.p&&l.p)?r:Object])],p);var f=n(167),g=n(695),v=n(546);let y=class{constructor(){this.operatingSystem=null}getOperatingSystem(){if(null!==this.operatingSystem)return this.operatingSystem;const{userAgent:t}=window.navigator;return this.operatingSystem="unknown",-1!==t.indexOf("Win")&&(this.operatingSystem="Windows"),-1!==t.indexOf("Mac")&&(this.operatingSystem="OSX"),-1!==t.indexOf("Linux")&&(this.operatingSystem="Linux"),-1!==t.indexOf("Android")&&(this.operatingSystem="Android"),-1!==t.indexOf("like Mac")&&(this.operatingSystem="iOS"),this.operatingSystem}};y=(0,s.Cg)([(0,a.Gr)()],y);var m=n(712),w=n(393);class b{constructor(t,e,n,i,o,r,s,a,c,d){this.logger=t,this.httpClient=e,this.skin=n,this.optInService=i,this.window=o,this.wikiConfig=r,this.geo=s,this.browser=a,this.operatingSystem=c,this.dataWarehouseUrl=d,this.initStartTime()}getTimeOrigin(){var t;return null===(t=window.performance)||void 0===t?void 0:t.timeOrigin}getCurrentTimestamp(){return Date.now()}initStartTime(){const t=new Date;this.startTime||(this.startTime=this.getTimeOrigin(),this.tzOffset=t.getTimezoneOffset())}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}getTrackingParams(){var t,e,n,i,o,r,s,a,c,d,u,l,h;return{browser:`${this.operatingSystem.getOperatingSystem()} ${this.browser.getBrowser()}`,browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.sessionId,pv_number:null===(i=null===(n=this.window.fandomContext)||void 0===n?void 0:n.tracking)||void 0===i?void 0:i.pvNumber,pv_number_global:null===(r=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===r?void 0:r.pvNumberGlobal,pv_unique_id:null===(a=null===(s=this.window.fandomContext)||void 0===s?void 0:s.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(d=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===d?void 0:d.beaconId,ua:null===(u=this.window.navigator)||void 0===u?void 0:u.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(h=null===(l=this.window.fandomContext)||void 0===l?void 0:l.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}generateBaseParams(t){return Object.assign(Object.assign(Object.assign({},t),this.getTimeBasedParams()),this.getTrackingParams())}buildDataWarehouseUrl(t,e){if(!e)return void this.logger.error("Error building DWH tracking URL");const n=new URLSearchParams(t);return n.sort(),`${e}?${n.toString()}`}sendEvent(t,e){var n;const i=this.generateBaseParams(t),o=this.buildDataWarehouseUrl(i,e);o&&(null===(n=this.httpClient.get(o,{mode:"cors"},5e3))||void 0===n||n.catch((t=>{this.logger.error("Failed to send data",t)})))}}var C,j,O,S,k,Q,E,T,I;let R=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/identityinfo")}send(t){this.sendEvent(t,this.dataWarehouseUrl)}};R=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseService")),(0,s.Qj)(1,(0,a.WQ)(d.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(C=void 0!==c.V&&c.V)?C:Object,"function"==typeof(j=void 0!==d.Q&&d.Q)?j:Object,"function"==typeof(O=void 0!==p&&p)?O:Object,"function"==typeof(S=void 0!==m.E&&m.E)?S:Object,"function"==typeof(k="undefined"!=typeof Window&&Window)?k:Object,"function"==typeof(Q=void 0!==f.j&&f.j)?Q:Object,"function"==typeof(E=void 0!==g.u&&g.u)?E:Object,"function"==typeof(T=void 0!==v.P&&v.P)?T:Object,"function"==typeof(I=void 0!==y&&y)?I:Object])],R);var _,P,W,A,M,x,D,G,N,L=n(489);let V=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/adengloadtimes")}send(t){this.sendEvent({event_name:t,load_time:this.getCurrentTimestamp()-this.getStartTime()},this.dataWarehouseUrl)}};var U,F,H,$,B,q,z,Y,K;V=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseService")),(0,s.Qj)(1,(0,a.WQ)(d.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(_=void 0!==c.V&&c.V)?_:Object,"function"==typeof(P=void 0!==d.Q&&d.Q)?P:Object,"function"==typeof(W=void 0!==p&&p)?W:Object,"function"==typeof(A=void 0!==m.E&&m.E)?A:Object,"function"==typeof(M="undefined"!=typeof Window&&Window)?M:Object,"function"==typeof(x=void 0!==f.j&&f.j)?x:Object,"function"==typeof(D=void 0!==g.u&&g.u)?D:Object,"function"==typeof(G=void 0!==v.P&&v.P)?G:Object,"function"==typeof(N=void 0!==y&&y)?N:Object])],V);let X=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/chromelabels")}send(t){this.sendEvent({event_name:"chrome_label",label:t},this.dataWarehouseUrl)}};var J,Z,tt,et,nt,it,ot,rt,st;X=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"ChromeLabelSender")),(0,s.Qj)(1,(0,a.WQ)(d.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(U=void 0!==c.V&&c.V)?U:Object,"function"==typeof(F=void 0!==d.Q&&d.Q)?F:Object,"function"==typeof(H=void 0!==p&&p)?H:Object,"function"==typeof($=void 0!==m.E&&m.E)?$:Object,"function"==typeof(B="undefined"!=typeof Window&&Window)?B:Object,"function"==typeof(q=void 0!==f.j&&f.j)?q:Object,"function"==typeof(z=void 0!==g.u&&g.u)?z:Object,"function"==typeof(Y=void 0!==v.P&&v.P)?Y:Object,"function"==typeof(K=void 0!==y&&y)?K:Object])],X);let at=class extends b{constructor(t,e,n,i,o,r,s,a,c){super(t,e,n,i,o,r,s,a,c,"https://beacon.wikia-services.com/__track/special/gdpr_events")}send(t){this.sendEvent(t,this.dataWarehouseUrl)}generateBaseParams(t){return Object.assign(Object.assign({},t),this.getTrackingParams())}getTrackingParams(){var t,e,n,i;return{lang_code:this.getLanguageCode()||"unknown",detected_geo:this.geo.getCountryCode()||"",beacon:null===(e=null===(t=this.window.fandomContext)||void 0===t?void 0:t.tracking)||void 0===e?void 0:e.beaconId,pv_unique_id:null===(i=null===(n=this.window.fandomContext)||void 0===n?void 0:n.tracking)||void 0===i?void 0:i.pvUID}}getLanguageCode(){var t,e,n;return this.wikiConfig.get("wgUserLanguage")||(null===(n=null===(e=null===(t=this.window)||void 0===t?void 0:t.navigator)||void 0===e?void 0:e.language)||void 0===n?void 0:n.toLowerCase().substring(0,2))}};var ct,dt,ut,lt,ht;at=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"ConsentsEventSender")),(0,s.Qj)(1,(0,a.WQ)(d.Q)),(0,s.Qj)(2,(0,a.WQ)(p)),(0,s.Qj)(3,(0,a.WQ)(m.E)),(0,s.Qj)(4,(0,a.WQ)(w.jf)),(0,s.Qj)(5,(0,a.WQ)(f.j)),(0,s.Qj)(6,(0,a.WQ)(g.u)),(0,s.Qj)(7,(0,a.WQ)(v.P)),(0,s.Qj)(8,(0,a.WQ)(y)),(0,s.Sn)("design:paramtypes",["function"==typeof(J=void 0!==c.V&&c.V)?J:Object,"function"==typeof(Z=void 0!==d.Q&&d.Q)?Z:Object,"function"==typeof(tt=void 0!==p&&p)?tt:Object,"function"==typeof(et=void 0!==m.E&&m.E)?et:Object,"function"==typeof(nt="undefined"!=typeof Window&&Window)?nt:Object,"function"==typeof(it=void 0!==f.j&&f.j)?it:Object,"function"==typeof(ot=void 0!==g.u&&g.u)?ot:Object,"function"==typeof(rt=void 0!==v.P&&v.P)?rt:Object,"function"==typeof(st=void 0!==y&&y)?st:Object])],at);let pt=class{constructor(t,e,n,i,o){this.logger=t,this.identityEventSender=e,this.loadTimeEventSender=n,this.chromeLabelSender=i,this.consentEventSender=o}track(t,e){switch(t){case L.i.identity:this.identityEventSender.send(e);break;case L.i.loadTime:this.loadTimeEventSender.send(e);break;case L.i.chromeLabel:this.chromeLabelSender.send(e);break;case L.i.consents:this.consentEventSender.send(e);break;default:this.logger.info("Invalid event type to track")}}};pt=(0,s.Cg)([(0,a._G)(),(0,s.Qj)(0,(0,a.MR)(c.V,c.O,"DataWarehouseService")),(0,s.Qj)(1,(0,a.WQ)(R)),(0,s.Qj)(2,(0,a.WQ)(V)),(0,s.Qj)(3,(0,a.WQ)(X)),(0,s.Qj)(4,(0,a.WQ)(at)),(0,s.Sn)("design:paramtypes",["function"==typeof(ct=void 0!==c.V&&c.V)?ct:Object,"function"==typeof(dt=void 0!==R&&R)?dt:Object,"function"==typeof(ut=void 0!==V&&V)?ut:Object,"function"==typeof(lt=void 0!==X&&X)?lt:Object,"function"==typeof(ht=void 0!==at&&at)?ht:Object])],pt)},489:(t,e,n)=>{"use strict";var i;n.d(e,{i:()=>i}),function(t){t[t.identity=0]="identity",t[t.loadTime=1]="loadTime",t[t.chromeLabel=2]="chromeLabel",t[t.consents=3]="consents"}(i||(i={}))},905:(t,e,n)=>{"use strict";n.d(e,{q:()=>a});var i,o=n(635),r=n(223),s=n(144);let a=class{constructor(t){this.logger=t}addLocatorFrame(){const t="____tcfapiLocator";if(window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.body,n=document.createElement("iframe");n.name=t,n.style.display="none",e.appendChild(n)}install(t=!1){const e=t?28:141;function n(t){try{let e=t.data;const n="string"==typeof e;if(n)try{e=JSON.parse(e)}catch(t){}const i=e.__tcfapiCall;i&&window.__tcfapi(i.command,i.parameter,(function(e,o){const r={__tcfapiReturn:{returnValue:e,success:o,callId:i.callId}};t.source.postMessage(n?JSON.stringify(r):r,"*")}))}catch(t){}}function i(t,n,i){"addEventListener"===t||"getTCData"===t||"ping"===t?i({cmpId:e,eventStatus:"tcloaded",cmpLoaded:!0,cmpStatus:"loaded",cmpVersion:n,displayStatus:"disabled",apiVersion:"2.2",tcfPolicyVersion:4,gdprApplies:!1},!0):i(void 0,!1)}window.__tcfapi?window.__tcfapi("ping",2,(t=>{"stub"===(null==t?void 0:t.cmpStatus)&&(window.__tcfapi=i,window.__tcfapi.msgHandler=n,this.addLocatorFrame(),window.addEventListener("message",n,!1),this.logger.info("__tcfapi installed"))})):(window.__tcfapi=i,window.__tcfapi.msgHandler=n,this.addLocatorFrame(),window.addEventListener("message",n,!1),this.logger.info("__tcfapi installed"))}};a=(0,o.Cg)([(0,r.Gr)(),(0,o.Qj)(0,(0,r.MR)(s.V,s.O,"TCF")),(0,o.Sn)("design:paramtypes",["function"==typeof(i=void 0!==s.V&&s.V)?i:Object])],a)},517:(t,e,n)=>{"use strict";n.d(e,{h:()=>h,u:()=>s});var i,o,r,s,a=n(635),c=n(223),d=n(393),u=n(874),l=n(144);!function(t){t.yes="Y",t.no="N",t.na="-"}(s||(s={}));let h=class{constructor(t,e,n){this.cookiesManager=t,this.window=e,this.logger=n,this.usPrivacyCookie="usprivacy",this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.explicitNotice=s.yes,this.lspaSupport=s.no}isUspApiAvailable(){return void 0!==this.window.__uspapi}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener(),this.logger.info("__uspapi installed")}getPrivacyStringCookie(){return this.cookiesManager.get(this.usPrivacyCookie)}createPrivacyCookie(t=s.na){const e=this.window.location.hostname,n=u.O.extract(e),i=t===s.na?`${this.USP_API_VERSION}${s.na}${s.na}${s.na}`:`${this.USP_API_VERSION}${this.explicitNotice}${t}${this.lspaSupport}`;this.cookiesManager.set(this.usPrivacyCookie,i,{domain:n,expires:365})}consentsUpdated(t){return{gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!t.startsWith(this.CCPA_TRACKING_ALLOWED)}}uspApiMessage(t,e,n){"ping"===t?n({uspapiLoaded:!1},!0):"getUSPData"===t?n({version:this.USP_API_VERSION,uspString:this.getPrivacyStringCookie()},!0):"getQueue"===t?n(this.queue,!0):this.queue.push([t,e,n])}addLocatorFrame(){const t="__uspapi";if(this.window.frames[t])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const e=document.createElement("iframe");e.name=t,e.style.display="none",document.body.appendChild(e)}addUspMessageListener(){this.window.addEventListener("message",(t=>{const e=this.convertUspMessageData(t);e&&this.uspMessageHandler(e,t)}),!1)}convertUspMessageData(t){try{return("string"==typeof t.data?JSON.parse(t.data):t.data).__uspapiCall}catch(t){}}uspMessageHandler(t,e){this.window.__uspapi(t.command,t.version,((n,i)=>{const o={__uspapiReturn:{returnValue:n,success:i,callId:t.callId}};e.source.postMessage(o,"*")}))}subscribe(t){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,(e=>{(null==e?void 0:e.uspString)&&t(this.consentsUpdated(e.uspString))}))}};h=(0,a.Cg)([(0,c.Gr)(),(0,a.Qj)(0,(0,c.WQ)(d.AZ)),(0,a.Qj)(1,(0,c.WQ)(d.jf)),(0,a.Qj)(2,(0,c.MR)(l.V,l.O,"USP")),(0,a.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof CookiesManager&&CookiesManager)?i:Object,"function"==typeof(o="undefined"!=typeof Window&&Window)?o:Object,"function"==typeof(r=void 0!==l.V&&l.V)?r:Object])],h)},712:(t,e,n)=>{"use strict";n.d(e,{E:()=>E});var i,o,r,s=n(635),a=n(144),c=n(223),d=n(155),u=n(349),l=n(85),h=n(439),p=n(569),f=n(695),g=n(517),v=n(905);let y=class{constructor(t,e,n){this.logger=t,this.uspApi=e,this.tcfApi=n,this.tcfApi.install()}subscribe(t){this.logger.info("__uspapi installed"),this.uspApi.subscribe(t)}};y=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Qj)(1,(0,c.WQ)(g.h)),(0,s.Qj)(2,(0,c.WQ)(v.q)),(0,s.Sn)("design:paramtypes",["function"==typeof(i=void 0!==a.V&&a.V)?i:Object,"function"==typeof(o=void 0!==g.h&&g.h)?o:Object,"function"==typeof(r=void 0!==v.q&&v.q)?r:Object])],y);var m,w,b,C,j=n(393);let O=class{constructor(t,e,n,i){this.window=t,this.geo=e,this.platform=n,this.logger=i,this.ONE_TRUST_PLATFORMS=[h.l.GIANTBOMB,h.l.TVGUIDE,h.l.TVGUIDE_MTC,h.l.METACRITIC_NEUTRON,h.l.METACRITIC,h.l.GAMESPOT,h.l.COMICVINE,h.l.GAMEFAQS]}shouldLoadOneTrust(){return this.ONE_TRUST_PLATFORMS.includes(this.platform.get())}get(t=!1){if(this.shouldLoadOneTrust()||t){if(void 0===this.window.trackingOptIn||void 0===this.window.trackingOptInInstances)return n.e(832).then(n.bind(n,675)).then((({OneTrustConsentStrategy:t})=>c.kL.resolve(t)));this.logger.warn("OneTrust should be loaded, but TrackingOptIn is present. Skipping OneTrust.")}if("fanatical"===this.platform.get())return n.e(482).then(n.bind(n,233)).then((({FanaticalConsentStrategy:t})=>c.kL.resolve(t)));const e=this.geo.getCountryCode();if(e){if("us"===e)return Promise.resolve(c.kL.resolve(y));if(p.e.includes(e))return n.e(224).then(n.bind(n,904)).then((({FandomGdprConsentStrategy:t})=>c.kL.resolve(t)))}return n.e(319).then(n.bind(n,322)).then((({StaticConsentStrategy:t})=>c.kL.resolve(t)))}};var S,k,Q;O=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.WQ)(j.jf)),(0,s.Qj)(1,(0,c.WQ)(f.u)),(0,s.Qj)(2,(0,c.WQ)(h.O)),(0,s.Qj)(3,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Sn)("design:paramtypes",["function"==typeof(m="undefined"!=typeof Window&&Window)?m:Object,"function"==typeof(w=void 0!==f.u&&f.u)?w:Object,"function"==typeof(b=void 0!==h.O&&h.O)?b:Object,"function"==typeof(C=void 0!==a.V&&a.V)?C:Object])],O);let E=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(t){this._trackingAllowed=t}constructor(t,e,n){this.communicationService=t,this.logger=e,this.consentProviderFactory=n,this.consentUpdated=!1,this._trackingAllowed=!1}init(t){const e=t.get("icFandom1TEnabled",!1);this.consentProviderFactory.get(e).then((t=>t.subscribe((t=>{this.logger.info("Sending consents: ",t,"update?",this.consentUpdated),this.consentUpdated&&this.sendConsentsUpdateToAdEngine(t),this.sendConsentsToAdEngine(t),this.consentUpdated||(this.consentUpdated=!0)}))))}sendConsentsToAdEngine(t){this.communicationService.emit(new d.r(u.c.CONSENT_READY,t))}sendConsentsUpdateToAdEngine(t){this.communicationService.emit(new d.r(u.c.CONSENT_UPDATE,t))}};E=(0,s.Cg)([(0,c.Gr)(),(0,s.Qj)(0,(0,c.WQ)(l.U)),(0,s.Qj)(1,(0,c.MR)(a.V,a.O,"OptInService")),(0,s.Qj)(2,(0,c.WQ)(O)),(0,s.Sn)("design:paramtypes",["function"==typeof(S=void 0!==l.U&&l.U)?S:Object,"function"==typeof(k=void 0!==a.V&&a.V)?k:Object,"function"==typeof(Q=void 0!==O&&O)?Q:Object])],E)},393:(t,e,n)=>{"use strict";n.d(e,{AZ:()=>i,eF:()=>a,jf:()=>r,kW:()=>o,kk:()=>s});const i=Symbol("COOKIES"),o=Symbol("NAVIGATOR"),r=Symbol("WINDOW"),s=Symbol("UUID"),a=Symbol("SENTRY")},610:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var i,o=n(635),r=n(223),s=n(393);let a=class{constructor(t){this.window=t}get(){var t;return null===(t=this.window.ads)||void 0===t?void 0:t.context}};a=(0,o.Cg)([(0,r._G)(),(0,o.Qj)(0,(0,r.WQ)(s.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof Window&&Window)?i:Object])],a)},248:(t,e,n)=>{"use strict";n.d(e,{s:()=>r});var i=n(635),o=n(223);let r=class{createScript(t,e="text/javascript",n=!0,i=null,o={},r={}){const s=document.createElement("script");if(s.async=n,s.defer=!n,s.type=e,s.src=t,Object.keys(o).forEach((t=>{s.setAttribute(t,o[t])})),Object.keys(r).forEach((t=>{s.dataset[t]=r[t]})),"string"==typeof i){const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t)}else(i||document.body).append(s);return s}loadScript(t,e="text/javascript",n=!0,i=null,o={},r={}){return new Promise(((s,a)=>{const c=this.createScript(t,e,n,i,o,r);c.onload=s,c.onerror=a}))}};r=(0,i.Cg)([(0,o._G)()],r)},546:(t,e,n)=>{"use strict";n.d(e,{P:()=>r});var i=n(635),o=n(223);let r=class{recognizeChromiumBuild(t,e){const n=e.match(/\b(OPR|Edg)\/(\d+)/);return null!==n?n.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"):"Chrome "+t}recognizeIEBuild(t){return`IE ${(/\brv[ :]+(\d+)/g.exec(t)||[""])[1]||""}`}getBrowserNameAndVersion(t){const[,e,n]=t.match(/(opera|chrome|safari|firefox|msie|trident|CriOS(?=\/))\/?\s*(\d+)/i)||[];return[e,n]}recognizeDefaultBrowser(t,e,n,i,o){const r=o?[i,o]:[e,n,"-?"],s=t.match(/version\/(\d+)/i);return null!==s&&r.splice(1,1,s[1]),r.join(" ")}getBrowser(){const{appName:t,appVersion:e,userAgent:n}=window.navigator,[i,o]=this.getBrowserNameAndVersion(n);return/trident/i.test(i)?this.recognizeIEBuild(n):"Chrome"===i||"CriOS"===i?this.recognizeChromiumBuild(o,n):this.recognizeDefaultBrowser(n,t,e,i,o)}};r=(0,i.Cg)([(0,o.Gr)()],r)},569:(t,e,n)=>{"use strict";n.d(e,{e:()=>i});const i=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf","ad","br","cn"]},538:(t,e,n)=>{"use strict";n.d(e,{p:()=>O});var i=n(635),o=n(223),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=window.device,a={},c=[];window.device=a;var d=window.document.documentElement,u=window.navigator.userAgent.toLowerCase(),l=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function h(t,e){return-1!==t.indexOf(e)}function p(t){return h(u,t)}function f(t){return d.className.match(new RegExp(t,"i"))}function g(t){var e=null;f(t)||(e=d.className.replace(/^\s+|\s+$/g,""),d.className=e+" "+t)}function v(t){f(t)&&(d.className=d.className.replace(" "+t,""))}function y(){a.landscape()?(v("portrait"),g("landscape"),m("landscape")):(v("landscape"),g("portrait"),m("portrait")),C()}function m(t){for(var e=0;e<c.length;e++)c[e](t)}a.macos=function(){return p("mac")},a.ios=function(){return a.iphone()||a.ipod()||a.ipad()},a.iphone=function(){return!a.windows()&&p("iphone")},a.ipod=function(){return p("ipod")},a.ipad=function(){var t="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return p("ipad")||t},a.android=function(){return!a.windows()&&p("android")},a.androidPhone=function(){return a.android()&&p("mobile")},a.androidTablet=function(){return a.android()&&!p("mobile")},a.blackberry=function(){return p("blackberry")||p("bb10")},a.blackberryPhone=function(){return a.blackberry()&&!p("tablet")},a.blackberryTablet=function(){return a.blackberry()&&p("tablet")},a.windows=function(){return p("windows")},a.windowsPhone=function(){return a.windows()&&p("phone")},a.windowsTablet=function(){return a.windows()&&p("touch")&&!a.windowsPhone()},a.fxos=function(){return(p("(mobile")||p("(tablet"))&&p(" rv:")},a.fxosPhone=function(){return a.fxos()&&p("mobile")},a.fxosTablet=function(){return a.fxos()&&p("tablet")},a.meego=function(){return p("meego")},a.cordova=function(){return window.cordova&&"file:"===location.protocol},a.nodeWebkit=function(){return"object"===r(window.process)},a.mobile=function(){return a.androidPhone()||a.iphone()||a.ipod()||a.windowsPhone()||a.blackberryPhone()||a.fxosPhone()||a.meego()},a.tablet=function(){return a.ipad()||a.androidTablet()||a.blackberryTablet()||a.windowsTablet()||a.fxosTablet()},a.desktop=function(){return!a.tablet()&&!a.mobile()},a.television=function(){for(var t=0;t<l.length;){if(p(l[t]))return!0;t++}return!1},a.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?h(screen.orientation.type,"portrait"):a.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},a.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?h(screen.orientation.type,"landscape"):a.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},a.noConflict=function(){return window.device=s,this},a.ios()?a.ipad()?g("ios ipad tablet"):a.iphone()?g("ios iphone mobile"):a.ipod()&&g("ios ipod mobile"):a.macos()?g("macos desktop"):a.android()?a.androidTablet()?g("android tablet"):g("android mobile"):a.blackberry()?a.blackberryTablet()?g("blackberry tablet"):g("blackberry mobile"):a.windows()?a.windowsTablet()?g("windows tablet"):a.windowsPhone()?g("windows mobile"):g("windows desktop"):a.fxos()?a.fxosTablet()?g("fxos tablet"):g("fxos mobile"):a.meego()?g("meego mobile"):a.nodeWebkit()?g("node-webkit"):a.television()?g("television"):a.desktop()&&g("desktop"),a.cordova()&&g("cordova"),a.onChangeOrientation=function(t){"function"==typeof t&&c.push(t)};var w="resize";function b(t){for(var e=0;e<t.length;e++)if(a[t[e]]())return t[e];return"unknown"}function C(){a.orientation=b(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(w="orientationchange"),window.addEventListener?window.addEventListener(w,y,!1):window.attachEvent?window.attachEvent(w,y):window[w]=y,y(),a.type=b(["mobile","tablet","desktop"]),a.os=b(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),C();const j=a;let O=class{getDeviceType(){return j.tablet()?"tablet":j.mobile()?"smartphone":"desktop"}};O=(0,i.Cg)([(0,o.Gr)()],O)},695:(t,e,n)=>{"use strict";n.d(e,{u:()=>u});var i,o,r=n(635),s=n(223),a=n(393),c=n(569);class d extends Error{constructor(t){super(t),this.name="GeoJsonParseException"}}let u=class{constructor(t,e){this.cookiesManager=t,this.window=e}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(t){this.geoData=t}getGeoData(){var t;if(void 0!==(null===(t=this.window.ads)||void 0===t?void 0:t.geo))return this.window.ads.geo;const e=this.getGeoDataFromCookie();return Object.keys(e).length?e:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){const t=this.cookiesManager.get("Geo");if(!t)return{};const e=decodeURIComponent(t);try{return JSON.parse(e)}catch(t){throw new d(`Failed to parse Geo cookie: ${t}`)}}getGeoDataFromOneTrust(){return this.window.OneTrust&&this.window.OneTrust.getGeolocationData()?{country:this.window.OneTrust.getGeolocationData().country}:{}}getCountryCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.country)||void 0===e?void 0:e.toLowerCase()}getRegionCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.region)||void 0===e?void 0:e.toLowerCase()}getContinentCode(){var t,e;return null===(e=null===(t=this.get())||void 0===t?void 0:t.continent)||void 0===e?void 0:e.toLowerCase()}isGdprCountry(){return c.e.includes(this.getCountryCode())}};u=(0,r.Cg)([(0,s.Gr)(),(0,r.Qj)(0,(0,s.WQ)(a.AZ)),(0,r.Qj)(1,(0,s.WQ)(a.jf)),(0,r.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof CookiesManager&&CookiesManager)?i:Object,"function"==typeof(o="undefined"!=typeof Window&&Window)?o:Object])],u)},858:(t,e,n)=>{"use strict";n.d(e,{Q:()=>s,j:()=>r});var i=n(635),o=n(223);class r extends Error{constructor(t){super(t),this.name=this.constructor.name}}let s=class{get(t){return(0,i.sH)(this,arguments,void 0,(function*(t,e={mode:"cors"},n=1e3){try{const i=new AbortController,o=setTimeout((()=>i.abort()),n),s=yield fetch(t,Object.assign({method:"GET",signal:i.signal},e));if(clearTimeout(o),!s.ok)throw new r(`HTTP error ${t}! Status: ${s.status}`);return s}catch(e){if(e instanceof r)throw e;throw new r(`HTTP error ${e} while sending request to ${t}!`)}}))}put(t,e){return(0,i.sH)(this,arguments,void 0,(function*(t,e,n={mode:"cors"}){try{const i=yield fetch(t,Object.assign({method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},n));if(!i.ok)throw new r(`HTTP error ${t}! Status: ${i.status}`);return i}catch(e){if(e instanceof r)throw e;throw new r(`HTTP error ${t}! ${e}`)}}))}};s=(0,i.Cg)([(0,o._G)()],s)},144:(t,e,n)=>{"use strict";n.d(e,{O:()=>c,V:()=>d});var i,o=n(635),r=n(38),s=n(223),a=n(393);class c{transform(t,e){return t.setLoggerGroup(e)}}let d=class{constructor(t){var e,n;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(n=null===(e=null==t?void 0:t.performance)||void 0===e?void 0:e.timeOrigin)&&void 0!==n?n:Date.now()}setLoggerGroup(t){return this.logGroup=t,this}getTimeDelta(){return Date.now()-this.initTime}getDebugGroup(){return r.C.get("identity_debug")}getTimeDeltaFixed(){return(this.getTimeDelta()/1e3).toFixed(4)}info(...t){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}warn(...t){this.loggingEnabled()&&console.warn(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}error(...t){this.loggingEnabled()&&console.error(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,t)}loggingEnabled(){return""!==this.debugGroup&&("1"===this.debugGroup||-1!==this.groups.indexOf(this.logGroup))}};d=(0,o.Cg)([(0,s._G)(),(0,o.Qj)(0,(0,s.WQ)(a.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof Window&&Window)?i:Object])],d)},439:(t,e,n)=>{"use strict";n.d(e,{O:()=>c,l:()=>o});var i,o,r=n(635),s=n(223),a=n(610);!function(t){t.F2="f2",t.BINGEBOT="bingebot",t.FUTHEAD="futhead",t.MUTHEAD="muthead",t.GAMESPOT="gamespot",t.COMICVINE="comicvine",t.GAMEFAQS="gamefaqs",t.METACRITIC="metacritic",t.METACRITIC_NEUTRON="metacritic-neutron",t.TVGUIDE="tvguide",t.TVGUIDE_MTC="tvguide-mtc",t.GIANTBOMB="giantbomb",t.FANATICAL="fanatical",t.FANDOMDESKTOP="fandomdesktop"}(o||(o={}));let c=class{constructor(t){this.adsContext=t}get(){var t;const e=this.adsContext.get();return(null!==(t=null==e?void 0:e.platform)&&void 0!==t?t:null==e?void 0:e.app)||this.detectPlatform()}detectPlatform(){var t,e,n;return void 0!==window.mw&&void 0!==(null===(n=null===(e=null===(t=window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===n?void 0:n.platformName)?window.ads.context.opts.platformName:this.checkHostname()}checkHostname(){const{hostname:t,pathname:e}=window.location;switch(!0){case t.includes("fandom"):return t.includes("bingebot")?o.BINGEBOT:o.F2;case t.includes("futhead"):return o.FUTHEAD;case t.includes("muthead"):return o.MUTHEAD;case t.includes("gamespot"):return t.includes("comicvine")?o.COMICVINE:t.includes("gamefaqs")?o.GAMEFAQS:o.GAMESPOT;case t.includes("metacritic"):return e.includes("news")?o.METACRITIC_NEUTRON:o.METACRITIC;case t.includes("tvguide"):return o.TVGUIDE;case t.includes("giantbomb"):return o.GIANTBOMB;case t.includes("fanatical"):return o.FANATICAL;default:return o.FANDOMDESKTOP}}};c=(0,r.Cg)([(0,s.Gr)(),(0,r.Qj)(0,(0,s.WQ)(a.i)),(0,r.Sn)("design:paramtypes",["function"==typeof(i=void 0!==a.i&&a.i)?i:Object])],c)},38:(t,e,n)=>{"use strict";n.d(e,{C:()=>i});class i{static getURLSearchParams(){const t=window.location.search.substring(1);return new URLSearchParams(t)}static get(t){return i.getURLSearchParams().get(t)}static stringify(t){const e=new URLSearchParams(t);return e.sort(),e.toString()}}},874:(t,e,n)=>{"use strict";n.d(e,{O:()=>r});var i=n(635),o=n(223);let r=class{static extract(t){const e=t.split(".");if(e.length<2)return t;let n=`.${e[e.length-2]}.${e[e.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(n)>=0&&(n=`.${e[e.length-3]}${n}`),n}};r=(0,i.Cg)([(0,o._G)()],r)},167:(t,e,n)=>{"use strict";n.d(e,{j:()=>a});var i,o=n(635),r=n(223),s=n(393);let a=class{constructor(t){this.window=t}get(t,e=null){var n,i,o;return null!==(o=null===(i=null===(n=this.window.mw)||void 0===n?void 0:n.config)||void 0===i?void 0:i.get(t))&&void 0!==o?o:e}};a=(0,o.Cg)([(0,r.Gr)(),(0,o.Qj)(0,(0,r.WQ)(s.jf)),(0,o.Sn)("design:paramtypes",["function"==typeof(i="undefined"!=typeof Window&&Window)?i:Object])],a)},223:(t,e,n)=>{"use strict";var i;n.d(e,{kL:()=>Q,cb:()=>p,WQ:()=>I,MR:()=>P,_G:()=>R,Gr:()=>_}),function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"}(i||(i={}));const o=i;var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function s(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function u(t){return!!t.useClass}function l(t){return!!t.useFactory}var h=function(){function t(t){this.wrap=t,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return t.prototype.createProxy=function(t){var e,n=this,i=!1;return new Proxy({},this.createHandler((function(){return i||(e=t(n.wrap()),i=!0),e})))},t.prototype.createHandler=function(t){var e={};return this.reflectMethods.forEach((function(n){e[n]=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return e[0]=t(),Reflect[n].apply(void 0,d(e))}})),e},t}();function p(t){if(void 0===t)throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new h(t)}function f(t){return"string"==typeof t||"symbol"==typeof t}function g(t){return"object"==typeof t&&"token"in t&&"transform"in t}function v(t){return!!t.useToken}function y(t){return null!=t.useValue}const m=function(){function t(){this._registryMap=new Map}return t.prototype.entries=function(){return this._registryMap.entries()},t.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},t.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},t.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},t.prototype.setAll=function(t,e){this._registryMap.set(t,e)},t.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),b=function(){this.scopedResolutions=new Map};var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(m);const O=function(){this.preResolution=new C,this.postResolution=new j};var S=new Map,k=function(){function t(t){this.parent=t,this._registry=new w,this.interceptors=new O,this.disposed=!1,this.disposables=new Set}return t.prototype.register=function(t,e,n){var i;if(void 0===n&&(n={lifecycle:o.Transient}),this.ensureNotDisposed(),i=function(t){return u(t)||y(t)||v(t)||l(t)}(e)?e:{useClass:e},v(i))for(var r=[t],s=i;null!=s;){var a=s.useToken;if(r.includes(a))throw new Error("Token registration cycle detected! "+d(r,[a]).join(" -> "));r.push(a);var c=this._registry.get(a);s=c&&v(c.provider)?c.provider:null}if((n.lifecycle===o.Singleton||n.lifecycle==o.ContainerScoped||n.lifecycle==o.ResolutionScoped)&&(y(i)||l(i)))throw new Error('Cannot use lifecycle "'+o[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(t,{provider:i,options:n}),this},t.prototype.registerType=function(t,e){return this.ensureNotDisposed(),f(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},t.prototype.registerInstance=function(t,e){return this.ensureNotDisposed(),this.register(t,{useValue:e})},t.prototype.registerSingleton=function(t,e){if(this.ensureNotDisposed(),f(t)){if(f(e))return this.register(t,{useToken:e},{lifecycle:o.Singleton});if(e)return this.register(t,{useClass:e},{lifecycle:o.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=t;return e&&!f(e)&&(n=e),this.register(t,{useClass:n},{lifecycle:o.Singleton})},t.prototype.resolve=function(t,e){void 0===e&&(e=new b),this.ensureNotDisposed();var n=this.getRegistration(t);if(!n&&f(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"Single"),n){var i=this.resolveRegistration(n,e);return this.executePostResolutionInterceptor(t,i,"Single"),i}if(function(t){return"function"==typeof t||t instanceof h}(t))return i=this.construct(t,e),this.executePostResolutionInterceptor(t,i,"Single"),i;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},t.prototype.executePreResolutionInterceptor=function(t,e){var n,i;if(this.interceptors.preResolution.has(t)){var o=[];try{for(var r=a(this.interceptors.preResolution.getAll(t)),s=r.next();!s.done;s=r.next()){var c=s.value;"Once"!=c.options.frequency&&o.push(c),c.callback(t,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(t,o)}},t.prototype.executePostResolutionInterceptor=function(t,e,n){var i,o;if(this.interceptors.postResolution.has(t)){var r=[];try{for(var s=a(this.interceptors.postResolution.getAll(t)),c=s.next();!c.done;c=s.next()){var d=c.value;"Once"!=d.options.frequency&&r.push(d),d.callback(t,e,n)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(t,r)}},t.prototype.resolveRegistration=function(t,e){if(this.ensureNotDisposed(),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.has(t))return e.scopedResolutions.get(t);var n,i=t.options.lifecycle===o.Singleton,r=t.options.lifecycle===o.ContainerScoped,s=i||r;return n=y(t.provider)?t.provider.useValue:v(t.provider)?s?t.instance||(t.instance=this.resolve(t.provider.useToken,e)):this.resolve(t.provider.useToken,e):u(t.provider)?s?t.instance||(t.instance=this.construct(t.provider.useClass,e)):this.construct(t.provider.useClass,e):l(t.provider)?t.provider.useFactory(this):this.construct(t.provider,e),t.options.lifecycle===o.ResolutionScoped&&e.scopedResolutions.set(t,n),n},t.prototype.resolveAll=function(t,e){var n=this;void 0===e&&(e=new b),this.ensureNotDisposed();var i=this.getAllRegistrations(t);if(!i&&f(t))throw new Error('Attempted to resolve unregistered dependency token: "'+t.toString()+'"');if(this.executePreResolutionInterceptor(t,"All"),i){var o=i.map((function(t){return n.resolveRegistration(t,e)}));return this.executePostResolutionInterceptor(t,o,"All"),o}var r=[this.construct(t,e)];return this.executePostResolutionInterceptor(t,r,"All"),r},t.prototype.isRegistered=function(t,e){return void 0===e&&(e=!1),this.ensureNotDisposed(),this._registry.has(t)||e&&(this.parent||!1)&&this.parent.isRegistered(t,!0)},t.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},t.prototype.clearInstances=function(){var t,e;this.ensureNotDisposed();try{for(var n=a(this._registry.entries()),i=n.next();!i.done;i=n.next()){var o=c(i.value,2),r=o[0],s=o[1];this._registry.setAll(r,s.filter((function(t){return!y(t.provider)})).map((function(t){return t.instance=void 0,t})))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.createChildContainer=function(){var e,n;this.ensureNotDisposed();var i=new t(this);try{for(var r=a(this._registry.entries()),s=r.next();!s.done;s=r.next()){var d=c(s.value,2),u=d[0],l=d[1];l.some((function(t){return t.options.lifecycle===o.ContainerScoped}))&&i._registry.setAll(u,l.map((function(t){return t.options.lifecycle===o.ContainerScoped?{provider:t.provider,options:t.options}:t})))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i},t.prototype.beforeResolution=function(t,e,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.preResolution.set(t,{callback:e,options:n})},t.prototype.afterResolution=function(t,e,n){void 0===n&&(n={frequency:"Always"}),this.interceptors.postResolution.set(t,{callback:e,options:n})},t.prototype.dispose=function(){return t=this,e=void 0,i=function(){var t;return function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,(function(e){switch(e.label){case 0:return this.disposed=!0,t=[],this.disposables.forEach((function(e){var n=e.dispose();n&&t.push(n)})),[4,Promise.all(t)];case 1:return e.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}));var t,e,n,i},t.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},t.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},t.prototype.construct=function(t,e){var n=this;if(t instanceof h)return t.createProxy((function(t){return n.resolve(t,e)}));var i,o=function(){var i=S.get(t);if(!i||0===i.length){if(0===t.length)return new t;throw new Error('TypeInfo not known for "'+t.name+'"')}var o=i.map(n.resolveParams(e,t));return new(t.bind.apply(t,d([void 0],o)))}();return"function"!=typeof(i=o).dispose||i.dispose.length>0||this.disposables.add(o),o},t.prototype.resolveParams=function(t,e){var n=this;return function(i,o){var r,s,a,u;try{return"object"==typeof(u=i)&&"token"in u&&"multiple"in u?g(i)?i.multiple?(r=n.resolve(i.transform)).transform.apply(r,d([n.resolveAll(i.token)],i.transformArgs)):(s=n.resolve(i.transform)).transform.apply(s,d([n.resolve(i.token,t)],i.transformArgs)):i.multiple?n.resolveAll(i.token):n.resolve(i.token,t):g(i)?(a=n.resolve(i.transform,t)).transform.apply(a,d([n.resolve(i.token,t)],i.transformArgs)):n.resolve(i,t)}catch(t){throw new Error(function(t,e,n){var i,o,r,s,a=c(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return i="Cannot inject the dependency "+(s=e,(null===(r=void 0===a?null:a)?"at position #"+s:'"'+r.split(",")[s].trim()+'" at position #'+s)+' of "')+t.name+'" constructor. Reason:',void 0===o&&(o="    "),d([i],n.message.split("\n").map((function(t){return o+t}))).join("\n")}(e,o,t))}}},t.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},t}(),Q=new k,E="injectionTokens";function T(t,e){return function(n,i,o){var r=Reflect.getOwnMetadata(E,n)||{};r[o]=e?{token:t,transform:e.transformToken,transformArgs:e.args||[]}:t,Reflect.defineMetadata(E,r,n)}}const I=function(t){return T(t)},R=function(){return function(t){S.set(t,function(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],n=Reflect.getOwnMetadata(E,t)||{};return Object.keys(n).forEach((function(t){e[+t]=n[t]})),e}(t))}},_=function(){return function(t){R()(t),Q.registerSingleton(t)}},P=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return T(t,{transformToken:e,args:n})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.")},698:(t,e,n)=>{var i;!function(t){!function(e){var i="object"==typeof globalThis?globalThis:"object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:function(){throw new ReferenceError("globalThis could not be found. Please polyfill globalThis before loading this module.")}(),o=r(t);function r(t,e){return function(n,i){Object.defineProperty(t,n,{configurable:!0,writable:!0,value:i}),e&&e(n,i)}}void 0!==i.Reflect&&(o=r(i.Reflect,o)),function(t,e){var n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:M("Symbol.toPrimitive not found."),o=n&&void 0!==Symbol.iterator?Symbol.iterator:M("Symbol.iterator not found."),r=Object.getPrototypeOf(Function),s="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:M("A valid Map constructor could not be found."),a="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:M("A valid Set constructor could not be found."),c="function"==typeof WeakMap?WeakMap:M("A valid WeakMap constructor could not be found."),d=n?Symbol.for("@reflect-metadata:registry"):void 0,u=function(){var t;return!b(d)&&j(e.Reflect)&&Object.isExtensible(e.Reflect)&&(t=e.Reflect[d]),b(t)&&(t=function(){var t,n,i,o;b(d)||void 0===e.Reflect||d in e.Reflect||"function"!=typeof e.Reflect.defineMetadata||(t=function(t){var e=t.defineMetadata,n=t.hasOwnMetadata,i=t.getOwnMetadata,o=t.getOwnMetadataKeys,r=t.deleteMetadata,s=new c;return{isProviderFor:function(t,e){var n=s.get(t);return!(b(n)||!n.has(e))||!!o(t,e).length&&(b(n)&&(n=new a,s.set(t,n)),n.add(e),!0)},OrdinaryDefineOwnMetadata:e,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:i,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:r}}(e.Reflect));var r=new c,u={registerProvider:l,getProvider:p,setProvider:g};return u;function l(e){if(!Object.isExtensible(u))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case t===e:break;case b(n):n=e;break;case n===e:break;case b(i):i=e;break;case i===e:break;default:void 0===o&&(o=new a),o.add(e)}}function h(e,r){if(!b(n)){if(n.isProviderFor(e,r))return n;if(!b(i)){if(i.isProviderFor(e,r))return n;if(!b(o))for(var s=R(o);;){var a=P(s);if(!a)return;var c=_(a);if(c.isProviderFor(e,r))return W(s),c}}}if(!b(t)&&t.isProviderFor(e,r))return t}function p(t,e){var n,i=r.get(t);return b(i)||(n=i.get(e)),b(n)?(b(n=h(t,e))||(b(i)&&(i=new s,r.set(t,i)),i.set(e,n)),n):n}function f(t){if(b(t))throw new TypeError;return n===t||i===t||!b(o)&&o.has(t)}function g(t,e,n){if(!f(n))throw new Error("Metadata provider not registered.");var i=p(t,e);if(i!==n){if(!b(i))return!1;var o=r.get(t);b(o)&&(o=new s,r.set(t,o)),o.set(e,n)}return!0}}()),!b(d)&&j(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,d,{enumerable:!1,configurable:!1,writable:!1,value:t}),t}(),l=function(t){var e=new c,n={isProviderFor:function(t,n){var i=e.get(t);return!b(i)&&i.has(n)},OrdinaryDefineOwnMetadata:function(t,e,n,o){i(n,o,!0).set(t,e)},OrdinaryHasOwnMetadata:function(t,e,n){var o=i(e,n,!1);return!b(o)&&S(o.has(t))},OrdinaryGetOwnMetadata:function(t,e,n){var o=i(e,n,!1);if(!b(o))return o.get(t)},OrdinaryOwnMetadataKeys:function(t,e){var n=[],o=i(t,e,!1);if(b(o))return n;for(var r=R(o.keys()),s=0;;){var a=P(r);if(!a)return n.length=s,n;var c=_(a);try{n[s]=c}catch(t){try{W(r)}finally{throw t}}s++}},OrdinaryDeleteMetadata:function(t,n,o){var r=i(n,o,!1);if(b(r))return!1;if(!r.delete(t))return!1;if(0===r.size){var s=e.get(n);b(s)||(s.delete(o),0===s.size&&e.delete(s))}return!0}};return u.registerProvider(n),n;function i(i,o,r){var a=e.get(i),c=!1;if(b(a)){if(!r)return;a=new s,e.set(i,a),c=!0}var d=a.get(o);if(b(d)){if(!r)return;if(d=new s,a.set(o,d),!t.setProvider(i,o,n))throw a.delete(o),c&&e.delete(i),new Error("Wrong provider for target.")}return d}}(u);function h(t,e,n){if(p(t,e,n))return!0;var i=A(e);return!C(i)&&h(t,i,n)}function p(t,e,n){var i=x(e,n,!1);return!b(i)&&S(i.OrdinaryHasOwnMetadata(t,e,n))}function f(t,e,n){if(p(t,e,n))return g(t,e,n);var i=A(e);return C(i)?void 0:f(t,i,n)}function g(t,e,n){var i=x(e,n,!1);if(!b(i))return i.OrdinaryGetOwnMetadata(t,e,n)}function v(t,e,n,i){x(n,i,!0).OrdinaryDefineOwnMetadata(t,e,n,i)}function y(t,e){var n=m(t,e),i=A(t);if(null===i)return n;var o=y(i,e);if(o.length<=0)return n;if(n.length<=0)return o;for(var r=new a,s=[],c=0,d=n;c<d.length;c++){var u=d[c];r.has(u)||(r.add(u),s.push(u))}for(var l=0,h=o;l<h.length;l++)u=h[l],r.has(u)||(r.add(u),s.push(u));return s}function m(t,e){var n=x(t,e,!1);return n?n.OrdinaryOwnMetadataKeys(t,e):[]}function w(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function b(t){return void 0===t}function C(t){return null===t}function j(t){return"object"==typeof t?null!==t:"function"==typeof t}function O(t,e){switch(w(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",o=I(t,i);if(void 0!==o){var r=o.call(t,n);if(j(r))throw new TypeError;return r}return function(t,e){if("string"===e){var n=t.toString;if(E(n)&&!j(o=n.call(t)))return o;if(E(i=t.valueOf)&&!j(o=i.call(t)))return o}else{var i;if(E(i=t.valueOf)&&!j(o=i.call(t)))return o;var o,r=t.toString;if(E(r)&&!j(o=r.call(t)))return o}throw new TypeError}(t,"default"===n?"number":n)}function S(t){return!!t}function k(t){var e=O(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function Q(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function E(t){return"function"==typeof t}function T(t){return"function"==typeof t}function I(t,e){var n=t[e];if(null!=n){if(!E(n))throw new TypeError;return n}}function R(t){var e=I(t,o);if(!E(e))throw new TypeError;var n=e.call(t);if(!j(n))throw new TypeError;return n}function _(t){return t.value}function P(t){var e=t.next();return!e.done&&e}function W(t){var e=t.return;e&&e.call(t)}function A(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===r)return e;if(e!==r)return e;var n=t.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return e;var o=i.constructor;return"function"!=typeof o||o===t?e:o}function M(t){throw t}function x(t,e,n){var i=u.getProvider(t,e);if(!b(i))return i;if(n){if(u.setProvider(t,e,l))return l;throw new Error("Illegal state.")}}t("decorate",(function(t,e,n,i){if(b(n)){if(!Q(t))throw new TypeError;if(!T(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var i=(0,t[n])(e);if(!b(i)&&!C(i)){if(!T(i))throw new TypeError;e=i}}return e}(t,e)}if(!Q(t))throw new TypeError;if(!j(e))throw new TypeError;if(!j(i)&&!b(i)&&!C(i))throw new TypeError;return C(i)&&(i=void 0),function(t,e,n,i){for(var o=t.length-1;o>=0;--o){var r=(0,t[o])(e,n,i);if(!b(r)&&!C(r)){if(!j(r))throw new TypeError;i=r}}return i}(t,e,n=k(n),i)})),t("metadata",(function(t,e){return function(n,i){if(!j(n))throw new TypeError;if(!b(i)&&!function(t){switch(w(t)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;v(t,e,n,i)}})),t("defineMetadata",(function(t,e,n,i){if(!j(n))throw new TypeError;return b(i)||(i=k(i)),v(t,e,n,i)})),t("hasMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),h(t,e,n)})),t("hasOwnMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),p(t,e,n)})),t("getMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),f(t,e,n)})),t("getOwnMetadata",(function(t,e,n){if(!j(e))throw new TypeError;return b(n)||(n=k(n)),g(t,e,n)})),t("getMetadataKeys",(function(t,e){if(!j(t))throw new TypeError;return b(e)||(e=k(e)),y(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!j(t))throw new TypeError;return b(e)||(e=k(e)),m(t,e)})),t("deleteMetadata",(function(t,e,n){if(!j(e))throw new TypeError;b(n)||(n=k(n));var i=x(e,n,!1);return!b(i)&&i.OrdinaryDeleteMetadata(t,e,n)}))}(o,i),void 0===i.Reflect&&(i.Reflect=t)}()}(i||(i={}))},635:(t,e,n)=>{"use strict";function i(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function o(t,e){return function(n,i){e(n,i,t)}}function r(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function s(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))}n.d(e,{Cg:()=>i,Qj:()=>o,Sn:()=>r,sH:()=>s}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}},i={};function o(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={exports:{}};return n[t](r,r.exports,o),r.exports}o.m=n,o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,n)=>(o.f[n](t,e),e)),[])),o.u=t=>({224:"fandom-gdpr-consents",319:"static-consents",482:"fanatical-consents",832:"one-trust-consents"}[t]+".js"),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="identity-engine:",o.l=(n,i,r,s)=>{if(t[n])t[n].push(i);else{var a,c;if(void 0!==r)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var l=d[u];if(l.getAttribute("src")==n||l.getAttribute("data-webpack")==e+r){a=l;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",e+r),a.src=n),t[n]=[i];var h=(e,i)=>{a.onerror=a.onload=null,clearTimeout(p);var o=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((t=>t(i))),e)return e(i)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=n[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={57:0};o.f.j=(e,n)=>{var i=o.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,o)=>i=t[e]=[n,o]));n.push(i[2]=r);var s=o.p+o.u(e),a=new Error;o.l(s,(n=>{if(o.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,r,[s,a,c]=n,d=0;if(s.some((e=>0!==t[e]))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);c&&c(o)}for(e&&e(n);d<s.length;d++)r=s[d],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0},n=self.webpackChunkidentity_engine=self.webpackChunkidentity_engine||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),(()=>{"use strict";var t=o(635),e=(o(698),o(223));function n(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}var i=function t(e,i){function o(t,o,r){if("undefined"!=typeof document){"number"==typeof(r=n({},i,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in r)r[a]&&(s+="; "+a,!0!==r[a]&&(s+="="+r[a].split(";")[0]));return document.cookie=t+"="+e.write(o,t)+s}}return Object.create({set:o,get:function(t){if("undefined"!=typeof document&&(!arguments.length||t)){for(var n=document.cookie?document.cookie.split("; "):[],i={},o=0;o<n.length;o++){var r=n[o].split("="),s=r.slice(1).join("=");try{var a=decodeURIComponent(r[0]);if(i[a]=e.read(s,a),t===a)break}catch(t){}}return t?i[t]:i}},remove:function(t,e){o(t,"",n({},e,{expires:-1}))},withAttributes:function(e){return t(this.converter,n({},this.attributes,e))},withConverter:function(e){return t(n({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(e)}})}({read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let s;const a=new Uint8Array(16);function c(){if(!s&&(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(a)}const d=[];for(let t=0;t<256;++t)d.push((t+256).toString(16).slice(1));var u,l=o(144),h=o(858),p=o(393),f=o(695),g=o(610);let v=class{constructor(t){this.adsContext=t}get(){var t;return"dev"===(null===(t=this.adsContext.get())||void 0===t?void 0:t.env)?"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/":"https://services.fandom.com/"}};var y,m,w,b,C;v=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(g.i)),(0,t.Sn)("design:paramtypes",["function"==typeof(u=void 0!==g.i&&g.i)?u:Object])],v);class j extends Error{constructor(t){super(t),this.name="GeoCookieException"}}let O=class{constructor(t,e,n,i,o){this.cookiesManager=t,this.httpClient=e,this.logger=n,this.geo=i,this.serviceBaseUrl=o,this.geoIPUrl=this.serviceBaseUrl.get()+"geoip/location"}setGeoCookieIfNotExist(){return(0,t.sH)(this,void 0,void 0,(function*(){if(this.cookiesManager.get("Geo"))this.logger.info("Geo cookie already exists");else try{const t=yield this.httpClient.get(this.geoIPUrl),{country_code:e,region:n,continent_code:i}=yield t.json(),o={country:e,region:n,continent:i},r=JSON.stringify(o);this.cookiesManager.set("Geo",r,{expires:365}),this.geo.set(o),this.logger.info("Geo cookie set")}catch(t){if(t instanceof h.j)throw new j(`Failed to fetch Geo cookie from pandora: ${t}`);throw new j(`Failed to set Geo cookie: ${t}`)}}))}};O=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Qj)(1,(0,e.WQ)(h.Q)),(0,t.Qj)(2,(0,e.MR)(l.V,l.O,"GeoCookie")),(0,t.Qj)(3,(0,e.WQ)(f.u)),(0,t.Qj)(4,(0,e.WQ)(v)),(0,t.Sn)("design:paramtypes",["function"==typeof(y="undefined"!=typeof CookiesManager&&CookiesManager)?y:Object,"function"==typeof(m=void 0!==h.Q&&h.Q)?m:Object,"function"==typeof(w=void 0!==l.V&&l.V)?w:Object,"function"==typeof(b=void 0!==f.u&&f.u)?b:Object,"function"==typeof(C=void 0!==v&&v)?C:Object])],O);var S,k,Q,E,T,I,R,_=o(155),P=o(349),W=o(874),A=o(167),M=o(517);let x=class{constructor(t,e,n,i,o,r,s){this.cookiesManager=t,this.window=e,this.wikiConfig=n,this.context=i,this.logger=o,this.geo=r,this.uspApi=s,this.ageGateCookie="ag",this.ageGateExpiryMs=31536e6}init(e){return(0,t.sH)(this,void 0,void 0,(function*(){var t,n;Boolean(null===(n=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===n?void 0:n.directedAtChildren)&&this.wikiConfig.get("wgAgeGateEnabled",!1)?void 0===this.cookiesManager.get(this.ageGateCookie)&&(yield this.waitForAgeGateDataAndSetCookie(e)):this.logger.info("disabled")}))}waitForAgeGateDataAndSetCookie(e){return(0,t.sH)(this,void 0,void 0,(function*(){return new Promise((t=>{e.on(P.c.AGE_GATE_DATA,(({payload:e})=>{this.setAgeGateCookie(e),"us"!==this.geo.getCountryCode()||e.adult||this.setUsPrivacyCookie(M.u.yes),t()}))}))}))}setAgeGateCookie(t){var e,n;t||this.logger.warn("Payload data missing, using defaults");const i=null!==(e=null==t?void 0:t.adult)&&void 0!==e&&e,o=null!==(n=null==t?void 0:t.timestamp)&&void 0!==n?n:Date.now();this.cookiesManager.set(this.ageGateCookie,i?"1":"0",{domain:this.getTopLevelDomain(),expires:new Date(o+this.ageGateExpiryMs)})}setUsPrivacyCookie(t){this.uspApi.createPrivacyCookie(t)}getTopLevelDomain(){const t=this.window.location.hostname;return W.O.extract(t)}};x=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Qj)(1,(0,e.WQ)(p.jf)),(0,t.Qj)(2,(0,e.WQ)(A.j)),(0,t.Qj)(3,(0,e.WQ)(g.i)),(0,t.Qj)(4,(0,e.MR)(l.V,l.O,"AgeGate")),(0,t.Qj)(5,(0,e.WQ)(f.u)),(0,t.Qj)(6,(0,e.WQ)(M.h)),(0,t.Sn)("design:paramtypes",["function"==typeof(S="undefined"!=typeof CookiesManager&&CookiesManager)?S:Object,"function"==typeof(k="undefined"!=typeof Window&&Window)?k:Object,"function"==typeof(Q=void 0!==A.j&&A.j)?Q:Object,"function"==typeof(E=void 0!==g.i&&g.i)?E:Object,"function"==typeof(T=void 0!==l.V&&l.V)?T:Object,"function"==typeof(I=void 0!==f.u&&f.u)?I:Object,"function"==typeof(R=void 0!==M.h&&M.h)?R:Object])],x);var D,G,N,L=o(85),V=o(712),U=o(489),F=o(841);let H=class{constructor(t,e,n){this.dataWarehouse=t,this.window=e,this.logger=n}activateTracking(){if(!this.isEnabled())return void this.logger.info("Hem Tracking is disabled");const t=this.extractHEMs();Object.keys(t).forEach((e=>{t[e]&&this.dataWarehouse.track(U.i.identity,{partner_name:"MediaWiki-"+e,partner_identity_id:t[e]})}))}isEnabled(){var t,e,n;return(null===(n=null===(e=null===(t=this.window.ads)||void 0===t?void 0:t.context)||void 0===e?void 0:e.opts)||void 0===n?void 0:n.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){const[t,e,n]=this.window.ads.context.opts.userEmailHashes;return{md5:t,sha1:e,sha256:n}}};var $,B;H=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(F.X)),(0,t.Qj)(1,(0,e.WQ)(p.jf)),(0,t.Qj)(2,(0,e.MR)(l.V,l.O,"HemTracking")),(0,t.Sn)("design:paramtypes",["function"==typeof(D=void 0!==F.X&&F.X)?D:Object,"function"==typeof(G="undefined"!=typeof Window&&Window)?G:Object,"function"==typeof(N=void 0!==l.V&&l.V)?N:Object])],H),function(t){t.tracking="tracking",t.page="page",t.site="site",t.partners="partners",t.targeting="targeting"}(B||(B={}));let q=class{constructor(t){this.window=t}get(t,e){return this.window.fandomContext[t][e]}set(t,e,n){this.window.fandomContext&&this.window.fandomContext[t]||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{[t]:{}})),this.window.fandomContext[t][e]=n.value}remove(t,e){try{delete this.window.fandomContext[t][e]}catch(t){}}};var z;q=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof($="undefined"!=typeof Window&&Window)?$:Object])],q);let Y=class{constructor(t){this.cookiesManager=t}get(t){return this.cookiesManager.get(t)}set(t,e){const{value:n,domain:i,expiresMS:o}=e,r=new Date((new Date).getTime()+o);this.cookiesManager.set(t,n.toString(),{domain:i,expires:r})}remove(t){this.cookiesManager.remove(t)}};Y=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(z="undefined"!=typeof CookiesManager&&CookiesManager)?z:Object])],Y);let K=class{generate(){let t="";for(;t.length<10;)t+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-"[64*Math.random()|0];return t}generateV2(){return`${this.generate()}.${Date.now()}`}};var X;K=(0,t.Cg)([(0,e._G)()],K);let J=class{constructor(t){this.cookiesManager=t}getNextNumberFromCookie(t){const e=parseInt(this.cookiesManager.get(t));return Number.isNaN(e)?1:e+1}};var Z,tt,et,nt,it,ot,rt,st;J=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(X="undefined"!=typeof CookiesManager&&CookiesManager)?X:Object])],J);const at=18e5,ct=15552e6;let dt=class{constructor(t,e,n,i,o,r,s,a){this.contextRepository=t,this.cookieRepository=e,this.uuid=n,this.beaconGenerator=i,this.pageViewNumberGenerator=o,this.window=r,this.wikiConfig=s,this.communicationService=a,this.communicationService.on(P.c.PAGE_CHANGED,(()=>{this.updatePageViewData()}))}set(t,e){this.contextRepository.set(B.tracking,t,e),this.cookieRepository.set(t,e)}remove(t){this.contextRepository.remove(B.tracking,t),this.cookieRepository.remove(t)}updatePageViewData(){const t=this.window.location.hostname,e=W.O.extract(t);this.contextRepository.set(B.tracking,"pvUID",{domain:t,expiresMS:at,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()}),this.set("pvNumber",{domain:t,expiresMS:at,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:e,expiresMS:at,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}updateUserTrackingData(){const t=this.window.location.hostname,e=W.O.extract(t),n=this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId"),i={domain:e,expiresMS:ct,value:n||this.beaconGenerator.generate()};this.contextRepository.set(B.tracking,"beaconId",i),this.cookieRepository.set("wikia_beacon_id",i);const o={domain:e,expiresMS:63072e6,value:this.cookieRepository.get("_b2")||this.beaconGenerator.generateV2()};this.cookieRepository.set("_b2",o);const r=this.wikiConfig.get("sessionId",this.window.sessionId)||this.cookieRepository.get("sessionId"),s={domain:e,expiresMS:at,value:r||this.uuid()};this.set("sessionId",s);const a=this.cookieRepository.get("wikia_session_id");this.cookieRepository.set("wikia_session_id",{domain:e,expiresMS:ct,value:a||this.beaconGenerator.generate()})}setup(){this.updateUserTrackingData(),this.updatePageViewData()}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};dt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(q)),(0,t.Qj)(1,(0,e.WQ)(Y)),(0,t.Qj)(2,(0,e.WQ)(p.kk)),(0,t.Qj)(3,(0,e.WQ)(K)),(0,t.Qj)(4,(0,e.WQ)(J)),(0,t.Qj)(5,(0,e.WQ)(p.jf)),(0,t.Qj)(6,(0,e.WQ)(A.j)),(0,t.Qj)(7,(0,e.WQ)(L.U)),(0,t.Sn)("design:paramtypes",["function"==typeof(Z=void 0!==q&&q)?Z:Object,"function"==typeof(tt=void 0!==Y&&Y)?tt:Object,"function"==typeof(et="undefined"!=typeof UuidProvider&&UuidProvider)?et:Object,"function"==typeof(nt=void 0!==K&&K)?nt:Object,"function"==typeof(it=void 0!==J&&J)?it:Object,"function"==typeof(ot="undefined"!=typeof Window&&Window)?ot:Object,"function"==typeof(rt=void 0!==A.j&&A.j)?rt:Object,"function"==typeof(st=void 0!==L.U&&L.U)?st:Object])],dt);class ut{constructor(t){this.options=t,this.tags={},this.errorQueue=[]}get inserted(){return Array.from(document.getElementsByTagName("script")).some((t=>t.src===ut.SENTRY_SCRIPT_CDN_URL))}get shouldLoad(){return Math.random()<this.options.sampleRate&&void 0!==ut.ALLOWED_URLS.find((t=>window.location.hostname.includes(t)))}get loaded(){return void 0!==window.Sentry}get initialized(){return void 0!==this.scope}setTags(t){this.tags=t}captureException(t){if(console.error(`[IE] (${this.options.release} ${this.options.environment}) Error captured:`,t),"development"!==this.options.environment&&this.shouldLoad){if(!this.inserted)return this.errorQueue.push(t),void this.loadSentry();if(!this.loaded)return this.errorQueue.push(t),void this.loadSentry();this.initialized||this.createSentryInstance(),this.scope.captureException(t)}}loadSentry(){return void 0===this.loadPromise&&(this.loadPromise=new Promise((t=>{const e=document.createElement("script");e.defer=!0,e.src=ut.SENTRY_SCRIPT_CDN_URL,e.crossOrigin="anonymous",e.integrity=ut.SENTRY_SCRIPT_INTEGRITY,e.onload=()=>{this.createSentryInstance(),this.flushErrorQueue(),t()},document.getElementsByTagName("script")[0].parentNode.append(e)}))),this.loadPromise}createSentryInstance(){const{breadcrumbsIntegration:t,BrowserClient:e,dedupeIntegration:n,defaultStackParser:i,httpContextIntegration:o,linkedErrorsIntegration:r,makeFetchTransport:s,Scope:a}=window.Sentry,c=new e(Object.assign(Object.assign({},this.options),{sampleRate:1,transport:s,stackParser:i,integrations:[t(),n(),o(),r()]}));this.scope=new a,this.scope.setClient(c),this.scope.setTags(Object.assign({url:window.location.href,userAgent:window.navigator.userAgent},this.tags))}flushErrorQueue(){this.errorQueue.forEach((t=>{var e;return null===(e=this.scope)||void 0===e?void 0:e.captureException(t)}))}}var lt;ut.ALLOWED_URLS=["fandom.com","fanatical.com","futhead.com","gamespot.com","giantbomb.com","metacritic.com","muthead.com","tvguide.com"],ut.SENTRY_SCRIPT_CDN_URL="//browser.sentry-cdn.com/7.105.0/bundle.min.js",ut.SENTRY_SCRIPT_INTEGRITY="sha384-iP5xIlbkWonIse3OwYtwpMAWScjrivRx8HUwVQK36MIK1LWXNF4oaIysvubyRK9V";let ht=class{constructor(t){this.sentry=t}resolve(t,e,n){var i;t.geoRequiresConsent&&t.gdprConsent||t.geoRequiresSignal&&!t.ccpaSignal||!t.geoRequiresSignal&&!t.geoRequiresConsent?(this.consentGiven=!0,null===(i=e())||void 0===i||i.catch((t=>this.sentry.captureException(t)))):(t.geoRequiresSignal&&t.ccpaSignal||t.geoRequiresConsent&&!t.gdprConsent)&&(this.consentGiven=!1,n())}getConsents(){return this.consentGiven}};ht=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.eF)),(0,t.Sn)("design:paramtypes",["function"==typeof(lt=void 0!==ut&&ut)?lt:Object])],ht);var pt=o(28),ft=o(38),gt=o(538),vt=o(546),yt=o(439);class mt{constructor(t,n,i){this.window=t,this.cookiesManager=n,this.communicationService=i,this.cacheStorage={},this.cacheKey="basset";const o=e.kL.resolve(l.V);o.setLoggerGroup("InstantConfig"),this.logger=o,this.resetCache()}resetCache(){const t=this.cookiesManager.get(this.cacheKey)||"";var e;this.cacheStorage=""===(e=t)||"string"!=typeof e?{}:e.split("|").reduce(((t,e)=>Object.assign(Object.assign({},t),function(t){const[e,n]=t.split(":"),i="true"===n,[o,r,s]=e.split("_");return{[o]:{name:o,group:r,limit:parseFloat(s)||void 0,result:i,withCookie:!0}}}(e))),{}),this.logger.info("reset cache",this.cacheStorage)}get(t){return this.cacheStorage[t]}set(t){this.cacheStorage[t.name]=t}remove(t){delete this.cacheStorage[t]}synchronizeCookie(){this.communicationService.on(P.c.CONSENT_READY,(({gdprConsent:t})=>{t&&(this.saveCookie(),this.communicationService.emit(new _.r(P.c.INSTANT_CONFIG_CACHE_READY)))}))}saveCookie(){const t=Object.keys(this.cacheStorage).map((t=>({key:t,value:this.cacheStorage[t]}))).filter((({value:t})=>t.withCookie)).reduce(((t,{key:e,value:n})=>Object.assign(Object.assign({},t),{[e]:n})),{}),e=this.window.location.hostname,n=W.O.extract(e),i=(o=t,Object.keys(o).slice(0,5).map(function(t){return e=>{const{name:n,group:i,limit:o,result:r}=t[e];return`${n}_${i}_${o}:${r}`}}(o)).join("|"));var o;this.cookiesManager.set(this.cacheKey,i,{domain:n,expires:180}),this.logger.info("saved in cookie",this.cacheStorage,i)}}class wt{constructor(t,e,n){this.cookiesManager=t,this.communicationService=e,this.topLevelDomain=W.O.extract(n.location.hostname)}get(t){return this.cookiesManager.get(t)}remove(t){this.cookiesManager.remove(t,{domain:this.topLevelDomain})}set(t,e,n){this.communicationService.on(P.c.CONSENT_READY,(i=>{if((!i.geoRequiresSignal||!i.ccpaSignal)&&(!i.geoRequiresConsent||i.gdprConsent)){const i={domain:this.topLevelDomain};n&&(i.expires=n),this.cookiesManager.set(t,e,i)}}))}}var bt,Ct,jt,Ot,St,kt,Qt,Et,Tt;let It=class{constructor(t,e,n,i,o,r,s,a,c){this.adsContext=t,this.device=e,this.browser=n,this.platform=i,this.geo=o,this.serviceBaseUrl=r,this.window=s,this.cookiesManager=a,this.logger=c}init(e){return(0,t.sH)(this,arguments,void 0,(function*(t,e={}){var n;const i=null===(n=this.adsContext.get())||void 0===n?void 0:n.env,o=this.serviceBaseUrl.get().slice(0,-1),r=this.platform.get(),s=this.geo.get(),a=`https://script.wikia.nocookie.net/fandom-ae-assets/icbm/${null!=i?i:"prod"}/icbm_state_${r}.json`,c=new pt.InstantConfigLoader({appName:r,instantConfigEndpoint:o,instantConfigFallbackEndpoint:a}),d=new mt(this.window,this.cookiesManager,t),u=new wt(this.cookiesManager,t,this.window),l=new pt.InstantConfigInterpreter(new pt.BrowserMatcher(this.browser.getBrowser()),new pt.DeviceMatcher(this.device.getDeviceType()),new pt.DomainMatcher,new pt.RegionMatcher(s),d,u);let h=yield c.getConfig();h=(new pt.InstantConfigOverrider).override(ft.C.getURLSearchParams(),h);const p=l.init(h,e);return this.repository=p.getValues(),d.synchronizeCookie(),this.logger.info("instantiated with",this.repository),this}))}get(t,e){return t in this.repository&&void 0!==this.repository[t]?this.repository[t]:e}};var Rt,_t;It=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(g.i)),(0,t.Qj)(1,(0,e.WQ)(gt.p)),(0,t.Qj)(2,(0,e.WQ)(vt.P)),(0,t.Qj)(3,(0,e.WQ)(yt.O)),(0,t.Qj)(4,(0,e.WQ)(f.u)),(0,t.Qj)(5,(0,e.WQ)(v)),(0,t.Qj)(6,(0,e.WQ)(p.jf)),(0,t.Qj)(7,(0,e.WQ)(p.AZ)),(0,t.Qj)(8,(0,e.MR)(l.V,l.O,"InstantConfig")),(0,t.Sn)("design:paramtypes",["function"==typeof(bt=void 0!==g.i&&g.i)?bt:Object,"function"==typeof(Ct=void 0!==gt.p&&gt.p)?Ct:Object,"function"==typeof(jt=void 0!==vt.P&&vt.P)?jt:Object,"function"==typeof(Ot=void 0!==yt.O&&yt.O)?Ot:Object,"function"==typeof(St=void 0!==f.u&&f.u)?St:Object,"function"==typeof(kt=void 0!==v&&v)?kt:Object,"function"==typeof(Qt="undefined"!=typeof Window&&Window)?Qt:Object,"function"==typeof(Et="undefined"!=typeof CookiesManager&&CookiesManager)?Et:Object,"function"==typeof(Tt=void 0!==l.V&&l.V)?Tt:Object])],It),function(t){t.LOCAL="local",t.IDENTITY_STORAGE="identity_storage"}(Rt||(Rt={}));let Pt=class{constructor(t){this.window=t}getItem(t){let e=null;try{return e=this.window.localStorage.getItem(t),JSON.parse(e)}catch(t){return e}}setItem(t,e){const n=e instanceof Object?JSON.stringify(e):e;try{this.window.localStorage.setItem(t,n)}catch(t){}}removeItem(t){return this.window.localStorage.removeItem(t)}};var Wt,At,Mt,xt,Dt;Pt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(_t="undefined"!=typeof Window&&Window)?_t:Object])],Pt);let Gt=class{constructor(t,e,n,i,o){this.logger=t,this.uuid=e,this.storage=n,this.serviceBaseUrl=i,this.httpClient=o,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.identityServiceUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return(0,t.sH)(this,void 0,void 0,(function*(){try{const t=yield this.httpClient.get(this.identityServiceUrl,{mode:"cors",credentials:"include"});return 200===t.status||202===t.status?t.json():this.createFallbackResponse()}catch(t){return this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",t),this.createFallbackResponse()}}))}postData(e){return(0,t.sH)(this,void 0,void 0,(function*(){const t={ppid:e.ppid},n=this.identityServiceUrl+"identity";return(yield this.httpClient.put(n,t,{mode:"cors",credentials:"include"})).json()}))}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(t){this.storage.setItem(this.IdentityStorageKey,t)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};var Nt,Lt,Vt,Ut,Ft;Gt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(p.kk)),(0,t.Qj)(2,(0,e.WQ)(Pt)),(0,t.Qj)(3,(0,e.WQ)(v)),(0,t.Qj)(4,(0,e.WQ)(h.Q)),(0,t.Sn)("design:paramtypes",["function"==typeof(Wt=void 0!==l.V&&l.V)?Wt:Object,"function"==typeof(At="undefined"!=typeof UuidProvider&&UuidProvider)?At:Object,"function"==typeof(Mt=void 0!==Pt&&Pt)?Mt:Object,"function"==typeof(xt=void 0!==v&&v)?xt:Object,"function"==typeof(Dt=void 0!==h.Q&&h.Q)?Dt:Object])],Gt);let Ht=class{constructor(t,e,n,i,o){this.storage=t,this.logger=e,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageClient=o}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.getLocalData();return t&&!t.synced&&this.setRemote(t),!t||this.isDeprecated(t)?this.getRemote():(this.setIdentityContextVariables(t),t)}))}setRemote(e){return(0,t.sH)(this,void 0,void 0,(function*(){try{yield this.identityStorageClient.postData(e);const t=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}catch(t){this.logger.error("Updating Identity LocalStorage data failed")}}))}isDeprecated(t){const e=this.instantConfigService.get("icIdentityTtl",6048e5),n=Date.now()-e;return!t.timestamp||t.timestamp-n<0}getLocalData(){return(0,t.sH)(this,void 0,void 0,(function*(){let t=yield this.identityStorageClient.getLocalData();if(!t){const e=this.getLocalPPID()||this.getAdmsPPID();e&&(t=yield this.migrateDeprecatedIdentity(e))}return t}))}migrateDeprecatedIdentity(e){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.setRemote({ppid:e,synced:!1});return this.clearDeprecatedLocalPpid(),t}))}getAdmsPPID(){var t,e;const n=this.storage.getItem("silver-surfer-active-data-v2");return null===(e=null===(t=null==n?void 0:n.IDENTITY)||void 0===t?void 0:t[0].payload)||void 0===e?void 0:e.identityToken}getLocalPPID(){return this.storage.getItem("ppid")}clearDeprecatedLocalPpid(){this.storage.removeItem("ppid")}getRemote(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}))}setIdentityContextVariables(t){t.over18&&this.windowContextRepository.set(B.tracking,"over_18",{value:"1"})}};var $t,Bt;Ht=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Pt)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(2,(0,e.WQ)(q)),(0,t.Qj)(3,(0,e.WQ)(It)),(0,t.Qj)(4,(0,e.WQ)(Gt)),(0,t.Sn)("design:paramtypes",["function"==typeof(Nt=void 0!==Pt&&Pt)?Nt:Object,"function"==typeof(Lt=void 0!==l.V&&l.V)?Lt:Object,"function"==typeof(Vt=void 0!==q&&q)?Vt:Object,"function"==typeof(Ut=void 0!==It&&It)?Ut:Object,"function"==typeof(Ft=void 0!==Gt&&Gt)?Ft:Object])],Ht);let qt=class{constructor(t,e){this.logger=t,this.identityStorageService=e}get(){return(0,t.sH)(this,void 0,void 0,(function*(){const t=yield this.identityStorageService.get();return this.logger.info(t),t.ppid}))}};var zt,Yt,Kt;qt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(Ht)),(0,t.Sn)("design:paramtypes",["function"==typeof($t=void 0!==l.V&&l.V)?$t:Object,"function"==typeof(Bt=void 0!==Ht&&Ht)?Bt:Object])],qt);let Xt=class{constructor(t,e,n){this.logger=t,this.uuid=e,this.storage=n}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");const t=this.uuid();return this.storage.setItem("ppid",t),t}};var Jt,Zt,te,ee,ne,ie,oe;Xt=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(1,(0,e.WQ)(p.kk)),(0,t.Qj)(2,(0,e.WQ)(Pt)),(0,t.Sn)("design:paramtypes",["function"==typeof(zt=void 0!==l.V&&l.V)?zt:Object,"function"==typeof(Yt="undefined"!=typeof UuidProvider&&UuidProvider)?Yt:Object,"function"==typeof(Kt=void 0!==Pt&&Pt)?Kt:Object])],Xt);let re=class{constructor(t,e,n,i,o,r,s){this.dataWarehouse=t,this.logger=e,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageRepository=o,this.localStorageRepository=r,this.communicationService=s}getPPID(t){switch(this.logger.info("active strategy: ",t),t){case Rt.IDENTITY_STORAGE:return this.identityStorageRepository;case Rt.LOCAL:default:return this.localStorageRepository}}generatePPID(){return(0,t.sH)(this,void 0,void 0,(function*(){try{const t=this.instantConfigService.get("icPpidRepository",Rt.LOCAL),e=yield this.getPPID(t).get();this.dataWarehouse.track(U.i.identity,{partner_name:"Google",partner_identity_id:e}),this.communicationService.emit(new _.r(P.c.IDENTITY_PARTNER_DATA_OBTAINED,{payload:{partnerName:"Google",partnerIdentityId:e}})),this.windowContextRepository.set(B.tracking,"ppid",{value:e}),this.logger.info("Passed PPID to page-level targeting")}catch(t){this.logger.error("Setting up PPID has failed!",t)}}))}setPpid(){return(0,t.sH)(this,void 0,void 0,(function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")}))}};var se,ae,ce,de;re=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(F.X)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"UserIdentity")),(0,t.Qj)(2,(0,e.WQ)(q)),(0,t.Qj)(3,(0,e.WQ)(It)),(0,t.Qj)(4,(0,e.WQ)(qt)),(0,t.Qj)(5,(0,e.WQ)(Xt)),(0,t.Qj)(6,(0,e.WQ)(L.U)),(0,t.Sn)("design:paramtypes",["function"==typeof(Jt=void 0!==F.X&&F.X)?Jt:Object,"function"==typeof(Zt=void 0!==l.V&&l.V)?Zt:Object,"function"==typeof(te=void 0!==q&&q)?te:Object,"function"==typeof(ee=void 0!==It&&It)?ee:Object,"function"==typeof(ne=void 0!==qt&&qt)?ne:Object,"function"==typeof(ie=void 0!==Xt&&Xt)?ie:Object,"function"==typeof(oe=void 0!==L.U&&L.U)?oe:Object])],re);let ue=class{constructor(t,e,n,i){this.window=t,this.logger=e,this.context=n,this.cookieRepository=i,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(t){this.coppaSubject=t,this.window.fandomContext.partners.directedAtChildren=t,this.window.fandomContext.partners.blockthrough={directedAtChildren:t}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var t,e;if(!Boolean(null===(e=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===e?void 0:e.directedAtChildren))return this.setIsCoppaSubjectInContext(!1),!1;try{const t="1"!==this.cookieRepository.get("ag");return this.setIsCoppaSubjectInContext(t),t}catch(t){this.logger.error("Error while reading age gate cookie")}}};var le,he,pe,fe,ge;ue=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"CoppaSubject")),(0,t.Qj)(2,(0,e.WQ)(g.i)),(0,t.Qj)(3,(0,e.WQ)(Y)),(0,t.Sn)("design:paramtypes",["function"==typeof(se="undefined"!=typeof Window&&Window)?se:Object,"function"==typeof(ae=void 0!==l.V&&l.V)?ae:Object,"function"==typeof(ce=void 0!==g.i&&g.i)?ce:Object,"function"==typeof(de=void 0!==Y&&Y)?de:Object])],ue);let ve=class{constructor(t,e,n,i,o){this.platform=e,this.window=n,this.httpClient=i,this.logger=o,this.enabled=!1,this.endpoint=`${t.get()}adeng/api/identity/metrics`}init(t){var e;const n=t.get("icMonitorTrafficThreshold",{identity:0});var i;this.enabled="object"==typeof(i=n)&&!Array.isArray(i)&&null!==i&&(null==n?void 0:n.identity)>0&&n.identity>=100*Math.random(),this.logger.info(`Metric reporter enabled: ${this.enabled}, threshold:`,n),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(e=this.window)||void 0===e||e.addEventListener("load",(()=>this.sendPerformanceMetrics())))}send(t,e=0){if(!this.enabled)return;const n=new URL(this.endpoint);n.searchParams.set("app",this.platform.get()),n.searchParams.set("action",t);const i=e>0?e:this.logger.getTimeDelta();n.searchParams.set("duration",Math.round(i).toString()),this.httpClient.get(n.toString(),{mode:"cors"},2e3).catch((()=>{this.logger.error("Failed to send data")}))}sendPerformanceMetrics(){const t=this.window.performance.getEntriesByType("navigation");t.length>0&&(this.send("document_content_loaded",t[0].domContentLoadedEventEnd),this.send("document_load_time",t[0].loadEventEnd))}};var ye;ve=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(v)),(0,t.Qj)(1,(0,e.WQ)(yt.O)),(0,t.Qj)(2,(0,e.WQ)(p.jf)),(0,t.Qj)(3,(0,e.WQ)(h.Q)),(0,t.Qj)(4,(0,e.MR)(l.V,l.O,"MetricReporterService")),(0,t.Sn)("design:paramtypes",["function"==typeof(le=void 0!==v&&v)?le:Object,"function"==typeof(he=void 0!==yt.O&&yt.O)?he:Object,"function"==typeof(pe="undefined"!=typeof Window&&Window)?pe:Object,"function"==typeof(fe=void 0!==h.Q&&h.Q)?fe:Object,"function"==typeof(ge=void 0!==l.V&&l.V)?ge:Object])],ve);let me=class{constructor(t){this.window=t}getItem(t){const e=this.window.sessionStorage.getItem(t);try{return JSON.parse(e)}catch(t){return e}}setItem(t,e){const n=e instanceof Object?JSON.stringify(e):e;this.window.sessionStorage.setItem(t,n)}removeItem(t){return this.window.sessionStorage.removeItem(t)}};me=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Sn)("design:paramtypes",["function"==typeof(ye="undefined"!=typeof Window&&Window)?ye:Object])],me);var we,be,Ce,je,Oe,Se,ke,Qe=o(248);let Ee=class{constructor(t,e,n,i,o,r,s){this.assetLoader=t,this.consentResolver=e,this.instantConfigService=n,this.coppaSubject=i,this.dataWarehouse=o,this.logger=r,this.metricReporter=s,this.partnerName="liveConnect",this.liveConnectScriptUrl="https://b-code.liadm.com/a-07ev.min.js",this.fallbackQf="0.3",this.live_connect_tracking_events={LIVE_CONNECT_STARTED:"live_connect_started",LIVE_CONNECT_CACHED:"live_connect_cached",LIVE_CONNECT_RESPONDED_UUID:"live_connect_responded_uuid"},this.idConfigMapping=[{id:"unifiedId",name:`${this.partnerName}-unifiedId`},{id:"sha2",name:this.partnerName,params:{qf:"0.3",resolve:"sha2"}},{id:"md5",name:`${this.partnerName}-md5`,params:{qf:"0.3",resolve:"md5"}},{id:"sha1",name:`${this.partnerName}-sha1`,params:{qf:"0.3",resolve:"sha1"}}]}isEnabled(){return this.consentResolver.getConsents()&&this.instantConfigService.get("icLiveConnect")&&this.instantConfigService.get("icLiveConnectCachingStrategy")&&this.instantConfigService.get("icIdentityPartners")&&!this.coppaSubject.isCoppaSubject()}init(){return(0,t.sH)(this,void 0,void 0,(function*(){this.isEnabled()?(this.setupStorage(),this.shouldLoadScript()?(this.logger.info("loading"),this.dataWarehouse.track(U.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_STARTED),this.assetLoader.loadScript(this.liveConnectScriptUrl,"text/javascript",!1).then((()=>{this.logger.info("loaded"),this.resolveAndTrackIds(),this.logEvent("live-connect-requested")}))):(this.dataWarehouse.track(U.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_CACHED),this.logger.info(`already loaded and available in ${this.storageConfig.type}Storage`))):this.logger.info("disabled")}))}resolveAndTrackIds(){var t;if(!window.liQ)return void this.logger.warn("window.liQ not available for tracking");const e=null===(t=this.instantConfigService.get("icLiveConnectQf"))||void 0===t?void 0:t.toString();window.liQ.resolve((t=>{this.trackIds(t)}),(t=>{console.error(t)}),{qf:e||this.fallbackQf,resolve:this.idConfigMapping.map((t=>t.id))})}trackIds(t){this.logger.info("resolve response:",t),Object.keys(t).forEach((e=>{if(!t[e])return;const n=this.getTrackingKeyName(e);if(this.isAvailableInStorage(n))return;"unifiedId"===e&&this.dataWarehouse.track(U.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_RESPONDED_UUID);const i=t[e];this.logger.info(`${e}: ${i}`),i&&(this.storage.setItem(n,i,this.storageConfig.ttl),this.dataWarehouse.track(U.i.identity,{partner_name:n,partner_identity_id:i}))}))}getTrackingKeyName(t){var e;return null===(e=this.idConfigMapping.find((e=>e.id===t)))||void 0===e?void 0:e.name}setupStorage(){this.storageConfig=this.instantConfigService.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=e.kL.resolve(Pt):this.storage=e.kL.resolve(me)}shouldLoadScript(){var t;if(!this.storageConfig)return!0;let e=!1;for(const n of this.storageConfig.mandatoryParams){const i=null===(t=this.idConfigMapping.find((t=>t.id===n)))||void 0===t?void 0:t.name;if(!this.isAvailableInStorage(i)){e=!0;break}}return e}isAvailableInStorage(t){return!!this.storage.getItem(t)}logEvent(t){this.metricReporter.send(t,1)}};var Te,Ie,Re;Ee=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(Qe.s)),(0,t.Qj)(1,(0,e.WQ)((0,e.cb)((()=>ht)))),(0,t.Qj)(2,(0,e.WQ)((0,e.cb)((()=>It)))),(0,t.Qj)(3,(0,e.WQ)(ue)),(0,t.Qj)(4,(0,e.WQ)(F.X)),(0,t.Qj)(5,(0,e.MR)(l.V,l.O,"liveConnect")),(0,t.Qj)(6,(0,e.WQ)(ve)),(0,t.Sn)("design:paramtypes",["function"==typeof(we=void 0!==Qe.s&&Qe.s)?we:Object,"function"==typeof(be=void 0!==ht&&ht)?be:Object,"function"==typeof(Ce=void 0!==It&&It)?Ce:Object,"function"==typeof(je=void 0!==ue&&ue)?je:Object,"function"==typeof(Oe=void 0!==F.X&&F.X)?Oe:Object,"function"==typeof(Se=void 0!==l.V&&l.V)?Se:Object,"function"==typeof(ke=void 0!==ve&&ve)?ke:Object])],Ee);let _e=class{constructor(t,e,n){this.logger=t,this.contextRepository=e,this.liveConnect=n}createPartnersContext(){this.contextRepository.set(B.partners,"anyclip",{value:{ppid:this.contextRepository.get(B.tracking,"ppid")}})}initializeTargetingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){}))}initializeTrackingPartners(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Initializing partners"),yield Promise.all([this.liveConnect.init()])}))}};var Pe,We,Ae,Me;_e=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"Partners")),(0,t.Qj)(1,(0,e.WQ)(q)),(0,t.Qj)(2,(0,e.WQ)(Ee)),(0,t.Sn)("design:paramtypes",["function"==typeof(Te=void 0!==l.V&&l.V)?Te:Object,"function"==typeof(Ie=void 0!==q&&q)?Ie:Object,"function"==typeof(Re=void 0!==Ee&&Ee)?Re:Object])],_e);let xe=class{constructor(t,e,n,i){this.logger=t,this.windowContextRepository=e,this.dataWarehouse=n,this.navigator=i}init(){return(0,t.sH)(this,void 0,void 0,(function*(){var t;if(this.logger.info("FacilitatedTesting init"),null===(t=this.navigator.cookieDeprecationLabel)||void 0===t?void 0:t.getValue){const t=yield this.navigator.cookieDeprecationLabel.getValue();t?(this.logger.info(`Received cookieDeprecationLabel: ${t}`),this.windowContextRepository.set(B.tracking,"chromeLabel",{value:t}),this.dataWarehouse.track(U.i.chromeLabel,t)):this.logger.info("Received empty cookieDeprecationLabel")}else this.logger.info("cookieDeprecationLabel not available")}))}};var De,Ge;xe=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"GooglePrivacySandbox:FacilitatedTesting")),(0,t.Qj)(1,(0,e.WQ)(q)),(0,t.Qj)(2,(0,e.WQ)(F.X)),(0,t.Qj)(3,(0,e.WQ)(p.kW)),(0,t.Sn)("design:paramtypes",["function"==typeof(Pe=void 0!==l.V&&l.V)?Pe:Object,"function"==typeof(We=void 0!==q&&q)?We:Object,"function"==typeof(Ae=void 0!==F.X&&F.X)?Ae:Object,"function"==typeof(Me="undefined"!=typeof Navigator&&Navigator)?Me:Object])],xe);let Ne=class{constructor(t,e){this.logger=t,this.facilitatedTesting=e}init(){this.logger.info("GooglePrivacySandbox init"),this.facilitatedTesting.init()}};var Le,Ve,Ue,Fe;Ne=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.MR)(l.V,l.O,"GooglePrivacySandbox")),(0,t.Qj)(1,(0,e.WQ)(xe)),(0,t.Sn)("design:paramtypes",["function"==typeof(De=void 0!==l.V&&l.V)?De:Object,"function"==typeof(Ge=void 0!==xe&&xe)?Ge:Object])],Ne);let He=class{constructor(t,e,n,i){this.contextRepository=t,this.browser=e,this.coppaSubject=n,this.consentResolver=i}init(){return(0,t.sH)(this,void 0,void 0,(function*(){!this.coppaSubject.isCoppaSubject()&&this.consentResolver.getConsents()&&(this.setAdTargetingGroup(),this.setBrowser())}))}setBrowser(){this.contextRepository.set(B.targeting,"browser",{value:this.browser.getBrowser().split(" ")[0]})}getRandomGroup(){return 5*Math.ceil(Math.random()%20*20)}setAdTargetingGroup(){const t=this.getRandomGroup(),e=Array.from({length:21},((t,e)=>100-5*e)).filter((e=>e>=t&&e>0));this.contextRepository.set(B.targeting,"adGroup",{value:e.toString()})}};var $e,Be,qe;He=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(q)),(0,t.Qj)(1,(0,e.WQ)(vt.P)),(0,t.Qj)(2,(0,e.WQ)(ue)),(0,t.Qj)(3,(0,e.WQ)(ht)),(0,t.Sn)("design:paramtypes",["function"==typeof(Le=void 0!==q&&q)?Le:Object,"function"==typeof(Ve=void 0!==vt.P&&vt.P)?Ve:Object,"function"==typeof(Ue=void 0!==ue&&ue)?Ue:Object,"function"==typeof(Fe=void 0!==ht&&ht)?Fe:Object])],He);let ze=class{constructor(t,e,n){this.partnersService=t,this.adTargetingGroups=e,this.logger=n}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up targeting"),yield this.partnersService.initializeTargetingPartners(),yield this.adTargetingGroups.init()}))}};var Ye,Ke,Xe,Je,Ze;ze=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(_e)),(0,t.Qj)(1,(0,e.WQ)(He)),(0,t.Qj)(2,(0,e.MR)(l.V,l.O,"TargetingService")),(0,t.Sn)("design:paramtypes",["function"==typeof($e=void 0!==_e&&_e)?$e:Object,"function"==typeof(Be=void 0!==He&&He)?Be:Object,"function"==typeof(qe=void 0!==l.V&&l.V)?qe:Object])],ze);let tn=class{constructor(t,e,n,i,o){var r,s,a;this.sentry=t,this.browser=e,this.device=n,this.platform=i,this.geo=o,this.sentry.setTags({browser:this.browser.getBrowser(),device:this.device.getDeviceType(),platform:this.platform.get(),geo_country:null!==(r=this.geo.getCountryCode())&&void 0!==r?r:"",geo_continent:null!==(s=this.geo.getContinentCode())&&void 0!==s?s:"",geo_region:null!==(a=this.geo.getRegionCode())&&void 0!==a?a:""})}};var en,nn;tn=(0,t.Cg)([(0,e._G)(),(0,t.Qj)(0,(0,e.WQ)(p.eF)),(0,t.Qj)(1,(0,e.WQ)(vt.P)),(0,t.Qj)(2,(0,e.WQ)(gt.p)),(0,t.Qj)(3,(0,e.WQ)(yt.O)),(0,t.Qj)(4,(0,e.WQ)(f.u)),(0,t.Sn)("design:paramtypes",["function"==typeof(Ye=void 0!==ut&&ut)?Ye:Object,"function"==typeof(Ke=void 0!==vt.P&&vt.P)?Ke:Object,"function"==typeof(Xe=void 0!==gt.p&&gt.p)?Xe:Object,"function"==typeof(Je=void 0!==yt.O&&yt.O)?Je:Object,"function"==typeof(Ze=void 0!==f.u&&f.u)?Ze:Object])],tn);let on=class{constructor(t,e){this.window=t,this.logger=e,this.queue=[]}install(){this.logger.info("installing consent queue");const t=this;return this.window.consentCallbackQueue=this,this.window.consentCallback=(e,n,i)=>t.push(e,n,i),this}push(t,e,n){this.logger.warn("dialog not resolved, enqueued:",t),this.queue.push({name:t,callback:e,category:n})}};on=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"ConsentCallbackQueue")),(0,t.Sn)("design:paramtypes",["function"==typeof(en="undefined"!=typeof Window&&Window)?en:Object,"function"==typeof(nn=void 0!==l.V&&l.V)?nn:Object])],on);var rn=o(569);const sn={C0001:"necessary",C0002:"performance",C0003:"functional",C0004:"targeting",C0005:"social"};class an{constructor(t,e){this.container=t;const n=t.OptanonWrapper;t.OptanonWrapper=()=>{e.resolve(),null==n||n()}}available(){return void 0!==this.container.OneTrust}ready(){var t,e;const n=this.container.OneTrust;return void 0!==this.container.OnetrustActiveGroups&&("opt-in"!==(null===(e=null===(t=n.GetDomainData())||void 0===t?void 0:t.ConsentModel)||void 0===e?void 0:e.Name)||n.IsAlertBoxClosed())}resolve(){var t;return null===(t=this.container.OnetrustActiveGroups)||void 0===t?void 0:t.split(",").map((t=>sn[t])).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{})}}class cn{constructor(t,e){this.optIn=t,this.cookiesManager=e}available(){return void 0!==this.cookiesManager.get("OptanonConsent")}ready(){return!this.optIn||void 0!==this.cookiesManager.get("OptanonAlertBoxClosed")}resolve(){var t;const e=null===(t=decodeURIComponent(this.cookiesManager.get("OptanonConsent")))||void 0===t?void 0:t.match(/groups=([^&]+)/);return e&&e[1]?e[1].toUpperCase().split(",").map((t=>{const e=t.split(":");return"1"===e[1]?sn[e[0]]:void 0})).filter((t=>t)).reduce(((t,e)=>Object.assign(Object.assign({},t),{[e]:!0})),{}):{}}}var dn,un,ln,hn;const pn={necessary:!0},fn={necessary:!0,performance:!0,functional:!0,targeting:!0,social:!0};let gn=class{constructor(t,e,n,i){this.container=t,this.logger=e,this.geo=n,this.cookiesManager=i,this.queue=t.consentCallbackQueue,this.optIn=!!n&&rn.e.includes(this.geo.getCountryCode()),void 0!==this.queue&&this.init()}resolve(){return!!this.wasResolved()||(this.ifAvailableThenResolveIfReady(this.apiConsentResolver)?(this.logger.info("API available, resolved?:",this.categories),this.wasResolved()):!!this.ifAvailableThenResolveIfReady(this.cookieConsentResolver)&&(this.logger.info("Cookies available, resolved?:",this.categories),this.wasResolved()))}wasResolved(){return void 0!==this.categories}init(){this.logger.info("Setting up with opt-in status:",this.optIn),this.apiConsentResolver=new an(this.container,this),this.cookieConsentResolver=new cn(this.optIn,this.cookiesManager),this.resolve()||setTimeout((()=>this.resolveWithFallback()),5e3)}resolveWithFallback(){this.resolve()||(this.apiConsentResolver.available()||this.cookieConsentResolver.available()?(this.logger.info("Still waiting for consent resolve with available api:",this.apiConsentResolver.available(),"or cookie:",this.cookieConsentResolver.available()),setTimeout((()=>this.resolveWithFallback),5e3)):(this.categories=this.fallback(),this.logger.info("Unable to resolve consent, fallback to:",this.categories),this.resolveQueue()))}ifAvailableThenResolveIfReady(t){const e=t.available();return e&&t.ready()&&(this.categories=t.resolve(),this.resolveQueue()),e}checkAndRun(t,e,n){return this.logger.info("About to callback:",t,"for:",n,"with:",this.categories),!(void 0!==n&&!this.categories[n]||(e(this.categories),0))}resolveQueue(){this.flushQueue(),this.queue.push=(t,e,n)=>this.checkAndRun(t,e,n),this.container.consentCallback=(t,e,n)=>this.checkAndRun(t,e,n)}flushQueue(){const t=this.queue.queue;this.logger.info("Consent resolved, flushing queue of size:",t.length);for(let e=t.length-1;e>=0;e--){const n=t[e];this.checkAndRun(n.name,n.callback,n.category)&&t.splice(e,1)}}fallback(){return this.optIn?pn:fn}};function vn(t){var e,n;return null===(n=null===(e=null==t?void 0:t.replace("/identity-service/",""))||void 0===e?void 0:e.replace("/index.js",""))||void 0===n?void 0:n.replace(/^v/,"")}var yn,mn,wn,bn,Cn,jn,On,Sn,kn,Qn,En,Tn,In,Rn,_n,Pn,Wn,An;gn=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(p.jf)),(0,t.Qj)(1,(0,e.MR)(l.V,l.O,"ConsentCallbackQueueHandler")),(0,t.Qj)(3,(0,e.WQ)(p.AZ)),(0,t.Sn)("design:paramtypes",["function"==typeof(dn="undefined"!=typeof Window&&Window)?dn:Object,"function"==typeof(un=void 0!==l.V&&l.V)?un:Object,"function"==typeof(ln=void 0!==f.u&&f.u)?ln:Object,"function"==typeof(hn="undefined"!=typeof CookiesManager&&CookiesManager)?hn:Object])],gn),e.kL.register(p.AZ,{useValue:i}),e.kL.register(p.kk,{useValue:function(t,e,n){if(r.randomUUID&&!e&&!t)return r.randomUUID();const i=(t=t||{}).random||(t.rng||c)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=i[t];return e}return function(t,e=0){return d[t[e+0]]+d[t[e+1]]+d[t[e+2]]+d[t[e+3]]+"-"+d[t[e+4]]+d[t[e+5]]+"-"+d[t[e+6]]+d[t[e+7]]+"-"+d[t[e+8]]+d[t[e+9]]+"-"+d[t[e+10]]+d[t[e+11]]+d[t[e+12]]+d[t[e+13]]+d[t[e+14]]+d[t[e+15]]}(i)}}),e.kL.register(p.kW,{useValue:navigator}),e.kL.register(p.jf,{useValue:window}),e.kL.register(p.kW,{useValue:navigator});let Mn=class{constructor(t,e,n,i,o,r,s,a,c,d,u,l,h,p,f,g,v,y){this.geoCookie=t,this.ageGateHandler=e,this.communicationService=n,this.optInService=i,this.hemTrackingService=o,this.trackingContextSetupService=r,this.consentResolver=s,this.instantConfigService=a,this.window=c,this.logger=d,this.ppidProvider=u,this.coppaSubject=l,this.metricReporterService=h,this.partnersService=p,this.googlePrivacySandbox=f,this.targetingService=y}initializeAgeGateHandler(){return(0,t.sH)(this,void 0,void 0,(function*(){return this.ageGateHandler.init(this.communicationService)}))}updateGTMConsent(t){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:t.toString()})}initializeTracking(){return(0,t.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),yield this.partnersService.initializeTrackingPartners(),yield this.partnersService.createPartnersContext(),this.communicationService.emit(new _.r(P.c.IDENTITY_READY)),this.metricReporterService.send("ready"),this.googlePrivacySandbox.init()}))}initializeTargeting(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.targetingService.initializeTargeting()}))}init(){return(0,t.sH)(this,void 0,void 0,(function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(this.communicationService),this.optInService.init(this.instantConfigService),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.send("init")}))}run(){var e,n;this.logger.info("Starting identity engine",`version: ${vn(null===(n=null===(e=this.window.ads)||void 0===e?void 0:e.version)||void 0===n?void 0:n.identity)}`),this.communicationService.once(P.c.CONSENT_READY,(e=>{this.trackingContextSetupService.setup(),this.consentResolver.resolve(e,(()=>(0,t.sH)(this,void 0,void 0,(function*(){this.updateGTMConsent(!0),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),this.initializeTargeting(),yield this.initializeTracking()}))),(()=>{this.updateGTMConsent(!1),this.initializeTargeting(),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.communicationService.emit(new _.r(P.c.IDENTITY_READY)),this.metricReporterService.send("ready"),this.logger.info("Tracking rejected")}))}))}};Mn=(0,t.Cg)([(0,e.Gr)(),(0,t.Qj)(0,(0,e.WQ)(O)),(0,t.Qj)(1,(0,e.WQ)(x)),(0,t.Qj)(2,(0,e.WQ)(L.U)),(0,t.Qj)(3,(0,e.WQ)(V.E)),(0,t.Qj)(4,(0,e.WQ)(H)),(0,t.Qj)(5,(0,e.WQ)(dt)),(0,t.Qj)(6,(0,e.WQ)(ht)),(0,t.Qj)(7,(0,e.WQ)(It)),(0,t.Qj)(8,(0,e.WQ)(p.jf)),(0,t.Qj)(9,(0,e.MR)(l.V,l.O,"IdentityEngine")),(0,t.Qj)(10,(0,e.WQ)(re)),(0,t.Qj)(11,(0,e.WQ)(ue)),(0,t.Qj)(12,(0,e.WQ)(ve)),(0,t.Qj)(13,(0,e.WQ)(_e)),(0,t.Qj)(14,(0,e.WQ)(Ne)),(0,t.Qj)(15,(0,e.WQ)(on)),(0,t.Qj)(16,(0,e.WQ)(gn)),(0,t.Qj)(17,(0,e.WQ)(ze)),(0,t.Sn)("design:paramtypes",["function"==typeof(yn=void 0!==O&&O)?yn:Object,"function"==typeof(mn=void 0!==x&&x)?mn:Object,"function"==typeof(wn=void 0!==L.U&&L.U)?wn:Object,"function"==typeof(bn=void 0!==V.E&&V.E)?bn:Object,"function"==typeof(Cn=void 0!==H&&H)?Cn:Object,"function"==typeof(jn=void 0!==dt&&dt)?jn:Object,"function"==typeof(On=void 0!==ht&&ht)?On:Object,"function"==typeof(Sn=void 0!==It&&It)?Sn:Object,"function"==typeof(kn="undefined"!=typeof Window&&Window)?kn:Object,"function"==typeof(Qn=void 0!==l.V&&l.V)?Qn:Object,"function"==typeof(En=void 0!==re&&re)?En:Object,"function"==typeof(Tn=void 0!==ue&&ue)?Tn:Object,"function"==typeof(In=void 0!==ve&&ve)?In:Object,"function"==typeof(Rn=void 0!==_e&&_e)?Rn:Object,"function"==typeof(_n=void 0!==Ne&&Ne)?_n:Object,"function"==typeof(Pn=void 0!==on&&on)?Pn:Object,"function"==typeof(Wn=void 0!==gn&&gn)?Wn:Object,"function"==typeof(An=void 0!==ze&&ze)?An:Object])],Mn),function(){(0,t.sH)(this,void 0,void 0,(function*(){var t,n;const i=function(){try{return"US"===e.kL.resolve(f.u).get().country?.01:.1}catch(t){return.01}}(),o=new ut({dsn:"https://3e92e20316cf4539a579d82f4294be77@o4504176096247808.ingest.sentry.io/4505432026447872",release:vn(null===(n=null===(t=window.ads)||void 0===t?void 0:t.version)||void 0===n?void 0:n.identity),environment:"production",sampleRate:i});try{e.kL.register(p.eF,{useValue:o}),e.kL.resolve(tn);const t=e.kL.resolve(Mn);yield t.init(),t.run()}catch(t){o.captureException(t)}}))}()})()})();
//# sourceMappingURL=index.js.map